%; whizzy chapter -dvi
% -initex iniptex -latex platex -format platex -bibtex jbibtex -fmt fmt
% 以上 whizzytex を使用する場合の設定。
 
%     Tokyo Debian Meeting resources
%     Copyright (C) 2012 Junichi Uekawa
%     Copyright (C) 2011 Nobuhiro Iwamatsu

%     This program is free software; you can redistribute it and/or modify
%     it under the terms of the GNU General Public License as published by
%     the Free Software Foundation; either version 2 of the License, or
%     (at your option) any later version.

%     This program is distributed in the hope that it will be useful,
%     but WITHOUT ANY WARRANTY; without even the implied warranty of
%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.

%     You should have received a copy of the GNU General Public License
%     along with this program; if not, write to the Free Software
%     Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

%  preview (shell-command (concat "evince " (replace-regexp-in-string "tex$" "pdf"(buffer-file-name)) "&"))

%%ここからヘッダ開始。

\documentclass[mingoth,a4paper]{jsarticle}
\usepackage{monthlyreport}
% 日付を定義する、毎月変わります。
\newcommand{\debmtgyear}{2014}
\newcommand{\debmtgmonth}{10}
\newcommand{\debmtgdate}{25}
% started from zero:
% (let ((year 2013) (month 7)) (+ (* (- year 2005) 12) month -1))
\newcommand{\debmtgnumber}{119}

% tikz picture の為のマクロ設定
\usepackage[dvipdfmx]{graphicx}
\usepackage{tikz}

\begin{document}

\begin{titlepage}
\thispagestyle{empty}
% タイトルページ:編集必要な部分は最初のマクロに飛ばすこと

\vspace*{-2cm}
第\debmtgnumber{}回 東京エリア Debian 勉強会資料\\
\hspace*{-2cm}
\includegraphics{image2012-natsu/dotdeb.pdf}\\
\hfill{}\debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日

% ここはアップデートすること
% 全角文字にしないとフォントのサイズが合わないので注意
\rotatebox{10}{\fontsize{30}{30} {\gt 特集：Debian x LibreOffice}}\\

\vspace*{-2cm}
\hfill{}\includegraphics[height=6cm]{image200502/openlogo-nd.eps}
\end{titlepage}

\newpage

\begin{minipage}[b]{0.2\hsize}
 \definecolor{titleback}{gray}{0.9}
 \colorbox{titleback}{\rotatebox{90}{\fontsize{80}{80} {\gt デビアン勉強会} }}
\end{minipage}
\begin{minipage}[b]{0.8\hsize}
\hrule
\vspace{2mm}
\hrule
\begin{multicols}{2}
\tableofcontents
\end{multicols}
\vspace{2mm}
\hrule
\end{minipage}

\dancersection{事前課題}{野島 貴英}

今回の事前課題は以下です:
\begin{enumerate}
 \item 本日、何の作業をやるかを宣言ください。
\end{enumerate}
この課題に対して提出いただいた内容は以下です。
\begin{multicols}{2}
{\small
\input{image201410/prework.tex}
}
\end{multicols}

\dancersection{Debian Trivia Quiz}{野島 貴英}

 Debianの昨今の話題についてのQuizです。

今回の出題範囲は\url{debian-devel-announce@lists.debian.org} や \url{debian-news@lists.debian.org}に投稿された
内容などからです。

\begin{multicols}{2}
\input{image201410/quiz.tex}
\end{multicols}

\dancersection{最近のDebian関連のミーティング報告}{野島 貴英}

\subsection{第117回東京エリアDebian勉強会}

\begin{itemize}
\item 場所はスクウェア・エニックスさんのセミナルームをお借りしての開催でした。６名の参加がありました。
\begin{itemize}
\item 野島さんにてDebConf14のビデオのトピックについて、
\item やまねさんにより、DebConf14の様子について口頭にて、
\end{itemize}
発表が行われました。
\item 残りの時間はもくもく会を行い、最後に成果発表をしました。
\item 今回は宴会の参加者が居なかったため、代わりに3名で夕食会となりました。
\end{itemize} 

　DebConf14では日本側からの発表が２本あったのは大変すばらしいと思います。
また、DebConf14のzackさんの発表「Debian in the Dark Ages of Free Software」は、Debian開発関係者には
非常に困った事態だと思います。こちらについては今後も真剣に考えていきたいと思います。

\subsection{第118回東京エリアDebian勉強会 in OSC 2014 Tokyo/Fall}

　OSC 2014 tokyo/fallへ東京エリアDebian勉強会として出張しました。 

\begin{itemize}
\item 10/18（土）にて岩松さんによりセミナ開催、Debianについてのブース出しを行いました。また、Debian Officail DeveloperのPaulLiuさんが遥々台湾から参加されました。
\item 10/19（日）は元々計画していませんでしたが、koedoyoshidaさんの厚意により、ブースを出していただきました。
\end{itemize} 
 
 10/18(土)のOSC 2014 tokyo/fallの参加者が、900名を超えたそうです。こういったイベントで盛り上げることにより、FOSS関係者やコミュニティが益々増えると良いですね。


% % (query-replace-regexp "<.*?>" "")
% % (query-replace-regexp "^[	 ]\+" "")

%-------------------------------------------------------------------------------
\dancersection{Debian x LibreOffice}{野島 貴英}
%-------------------------------------------------------------------------------
\index{debian-libreoffice}

\subsection{はじめに}

 今回の東京エリアDebian勉強会は、関東LibreOfficeさんとコラボで開くという初の試みを行います。ここでは、Debianから見たLibreOfficeに関して、Debianの開発に関わる点についていくつか述べてみたいと思います。

\subsection{Debianとupstreamコミュニティの関係}

 Debianは、Linux OSのディストリビューションでも、世界一コミュニティ主導で開発が行われるコミュニティです。ここで、Debian Projectの文化として、Upstream Firstという考え方があり、Debianで、特定のソフトウェアで生じた問題などは、最初にupstreamへフィードバックすることが求められます。当然ですが、upstreamの意向も汲む必要がありますし、upstreamとは良好な関係を築き、建設的な情報交換を行う事が、Debian Projectの方針として定まっています。

\subsection{LibreOfficeのバージョン}

 2014/10/25現在のリポジトリを確認すると、LibreOfficeのパッケージは以下のバージョンとなっています。

\begin{table}[ht]
\begin{center}
\small
\begin{tabular}{|l|p{7cm}|l|l|}
\hline 
Debian&Debianアーキテクチャ&LibreOfficeバージョン& 備考\\ \hline \hline
squeeze-backports & amd64 armel i386 kfreebsd-i386 mips mipsel powerpc s390 sparc & 3.5.4 & \\ \cline{2-4}
 & ia64 kfreebsd-amd64 & 3.3.3 & \\ \hline
wheezy(stable) & amd64 armel armhf i386 ia64 kfreebsd-amd64 kfreebsd-i386 mips mipsel powerpc s390 s390x sparc & 3.5.4 & \\ \hline
wheezy-backports & amd64 armel armhf i386 ia64 mipsel powerpc s390 s390x & 4.3.2 & \\ \cline{2-4}
 & sparc & 4.2.6 & \\ \cline{2-4}
 & mips & 4.2.5  & \\ \cline{2-4}
 & kfreebsd-(amd64|i386)& 4.0.3 & \\ \hline
\end{tabular}
\end{center}
\caption{DebianのバージョンとLibreOfficeのバージョン(2014/10/25)}
\label{tab:debian-vs-libreoffice-version}
\end{table}

\begin{table}[ht]
\begin{center}
\small
\begin{tabular}{|l|p{7cm}|l|l|}
\hline 
Debian&Debianアーキテクチャ&LibreOfficeバージョン& 備考\\ \hline \hline
squeeze-backports & amd64 armel i386 kfreebsd-i386 mips mipsel powerpc s390 sparc & 3.5.4 & \\ \cline{2-4}
 & ia64 kfreebsd-amd64 & 3.3.3 & \\ \hline
wheezy(stable) & amd64 armel armhf i386 ia64 kfreebsd-amd64 kfreebsd-i386 mips mipsel powerpc s390 s390x sparc & 3.5.4 & \\ \hline
wheezy-backports & amd64 armel armhf i386 ia64 mipsel powerpc s390 s390x & 4.3.2 & \\ \cline{2-4}
 & sparc & 4.2.6 & \\ \cline{2-4}
 & mips & 4.2.5  & \\ \cline{2-4}
 & kfreebsd-(amd64\textbar i386)& 4.0.3 & \\ \hline
jessie(testing) & amd64 arm64 armel armhf i386 kfreebsd-amd64 kfreebsd-i386 mips mipsel powerpc ppc64el s390x & 4.3.2 & \\ \hline
sid(unstable) & amd64 armel armhf i386 kfreebsd-amd64 kfreebsd-i386 mipsel powerpc ppc64el s390x sparc & 4.3.3\~{}rc2 & \\ \cline{2-4} 
 & arm64 mips alpha ppc64 & 4.3.2 & \\ \cline{2-4}
 & hppa & 4.1.6\~{}rc2 & \\ \cline{2-4}
 & powerpcspe & 4.1.4 & \\ \hline
experimental & amd64 armhf i386 ppc64el & 4.4.0\~{}alpha1 & \\ \hline
\end{tabular}
\end{center}
\caption{DebianのバージョンとLibreOfficeのバージョン(2014/10/25)}
\label{tab:debian-vs-libreoffice-version}
\end{table}

\subsection{使う側のDebian固有の事情の情報源}

 DebianでLibreOfficeを使う場合、Debian固有で生じる事も知っておいた方が良いです。こちらの情報源についていくつか紹介しておきます。

\begin{table}[ht]
\begin{center}
\begin{tabular}{|l|p{7cm}|l|}
\hline
種別 & 場所 & 備考 \\ \hline \hline
ファイル & /usr/share/doc/libreoffice/ README.Debian & \\ \hline
wiki & \url{https://wiki.debian.org/LibreOffice} & \\ \hline
bugレポート & \url{https://bugs.debian.org/libreoffice} & \\ \hline
\end{tabular}
\end{center}
\caption{Debian固有のLibreOffice情報}
\label{tab:debian-specific-about-libreoffice}
\end{table}

\subsection{DebianでのLibreOfficeのパッケージ開発についていくつか}

 東京エリアDebian勉強会は開発者の集まりですので、ここではパッケージ開発固有の事情に関していくつか紹介します。

\subsubsection{メンテナ}

 DebianでのLibreOfficeのパッケージ開発は、Debian LibreOffice Maintainers ( debian-openoffice\@lists.debian.org )という
コミュニティが用意されています。ただ、実際にMLを見るとわかるのですが、Debianについては、ほぼRene Engelhardさんにより精力的にメンテナンスが行われている状態です。

\subsubsection{パッケージのソースコード}

　Debianのパッケージの開発のgitリポジトリは、\url{http://anonscm.debian.org/cgit/pkg-openoffice/libreoffice.git}で管理されています。見ると判りますが、各ブランチが切られており、ubuntu用なども見えます。

　また、apt-get source libreofficeすると、debian/README.debian-sourceが入っています。こちらを読むと判りますが、

\begin{itemize}
\item バージョンアップしたパッケージをどう作るかについて、工数が少なくなるような、一定のやり方を定めています。debian/rulesファイルも、非常にうまく作られていて、このやり方で多くの事が出来るようになっています。
\item LibreOffice自体巨大なソースですので、必然的にdebian/controlファイルも巨大化します。こちらをメンテしやすくするため、パッケージの種別毎にcontorlファイルが多数分割されており、debian/rulesでcontrolファイルを生成できるようになっています。
\item debian/*.inファイルを使って、パッケージ内部に梱包する様々な設定ファイルを各Debianの環境に合わせて修正・合成しています。
\item dpkg-devで梱包されている/usr/share/dpkg/*.mkファイルに基づき、configureに必要なオプションが作られていきます。
\item DFSG Freeにこだわる必要があるため、openoffice由来のソースから、DFSG Freeでないものを抹消しています。
\end{itemize}

\subsubsection{Debian固有のパッチの紹介}

 Debian固有の事情に合わせてパッチがdebian/patch以下に収められています。Debianだけにとどまらない内容のパッチも若干含まれていますが、いずれ（あるいはすでに）upstreamへフィードバックされる予定のはずです。

　いくつもパッチがありますが、表\ref{tab:debian-specific-libreoffice-patches}にDebian固有で面白いものを抜き出して列挙してみます(用語を表\ref{tab:debian-specific-libreoffice-patches-usage}に載せます。）

\begin{table}[ht]
\begin{center}
\small
\begin{tabular}{|l|p{7cm}|p{3cm}|}
\hline
パッチ名 & 内容 & 備考 \\ \hline \hline
aarch64.diff & arm64用のパッチ。unoを取うためのarm64用のコードが追加されている。& \\ \hline
aotcompile-256M-default.diff & MAX\_CLASSES\_PER\_JAR = 256,MAX\_BYTES\_PER\_JAR = 262144をビルドマシンの搭載メモリサイズによらず固定にするパッチ。& \\ \hline
config-sub-guess-update.diff & システムがglibc/ulibc/dietlibcであるかを検出して適切なLIBC変数を設定する。さらに、古いシステム（Next、hp300、386BSD等...)の判定コードを削除。& 注：debianに関わるもののみ説明 \\ \hline
debian-hardened-buildflags-CPPFLAGS.diff & Jessieリリースゴールの１つであるhardeningを搭載する。 & \\ \hline
sensible-lomua.diff & Debianの持つ各種デスクトップ環境に合わせるためのパッチ。MUAを適切に設定。& \\ \hline
split-evoab.diff & gnomeのMUAであるevolutionのアドレス帳連携のドライバでEVOAB2を有効にするパッチ。& \\ \hline
earch-usr-share-for-images.diff & 画像のサーチパスの検索順番をdebianにあわせるべく変更（プログラムの改造含む）。& \\ \hline
help-msg-add-package-info.diff & ヘルプファイルがインストールされていない場合に出るエラーメッセージに、libreoffice-help-en-usパッケージ、libreoffice-help-<language-code>パッケージを導入して欲しい旨表示するようにするパッチ & \\ \hline
debian-debug.diff & -g1をgccのデバッグオプションとして利用し、デバッグシンボルファイルのサイズを減らす。& \\ \hline
gcj-safe-jni-h-include.diff & gcjで、jni.hがシステムにあわせてincludeされるように変更。& \\ \hline
mention-java-common-package.diff & Javaに関する問題があった場合、libreoffice-java-commonパッケージを入れるように促すメッセージを追加。& \\ \hline
jurt-soffice-location.diff & sofficeを指定された場合に、debianでのインストール位置を正確に返却 & \\ \hline
reportdesign-mention-package.diff & Oracle Report Builder の機能が必要な場合、libreoffice-report-builderを入れてくれと促す。& \\ \hline
system-coinmp.diff & coinmpに対応する。 & \\ \hline
\end{tabular}
\end{center}
\caption{Debian固有のパッチの中身}
\label{tab:debian-specific-libreoffice-patches}
\end{table}

\begin{table}[ht]
\begin{center}
\small
\begin{tabular}{|l|p{10cm}|}
\hline
用語 & 説明 \\ \hline \hline
uno &  Universal Network Object。CORBAとかCOM(DCOM)等のオブジェクト指向の通信により、LibreOfficeのAPI呼び出しを実現する仕組み。\url{https://wiki.openoffice.org/wiki/Documentation/DevGuide/ ProUNO/Introduction} \\ \hline
hardening & コンパイラにセキュリティ強化の施策を打たせる事。\url{https://wiki.debian.org/Hardening} \\ \hline
coinmp & COmputational Infrastructire for Operations Research(CON-OR)のライブラリ。OR用途。\url{https://projects.coin-or.org/} \\ \hline
\end{tabular}
\end{center}
\caption{用語}
\label{tab:debian-specific-libreoffice-patches-usage}
\end{table}


\subsection{おわりに}

　ここでは、LibreOfficeがDebianではどうパッケージ化されているかについて説明してみました。Debianでは、arm64アーキテクチャ対応が目玉となっていますが、LibreOfficeのDebianパッチとして独自で搭載していたりします。こういったDebian側からの改造がupstreamに取り込まれ、upstreamも対応アーキテクチャが増えていくのは良いことだと思います。同じFOSSの仲間であるDebianとLibreOfficeが相互に発展していく感じがソースからも読み取れて感慨深いです。
 

%-------------------------------------------------------------------------------
\dancersection{会場での無線LANのつなぎ方}{野島 貴英,Roger}
%-------------------------------------------------------------------------------
 \subsection{はじめに}

　今回試験として、会場側でフィルタ無しのグローバル回線を用意しました。
ただ、会場側のセキュリティポリシーにより、wpa-psk AES hidden SSIDという
方式での提供となります。

　以下にDebianマシンでの接続方法を記載します。

 また、自分の環境では違うやり方でつながったという方は、野島まで
教えて下さい。こちらでもノウハウとして溜めていく予定です。

 \subsection{wpasupplicant及び/etc/network/interfacesを利用の場合}

 もっとも良いマニュアルは、/usr/share/doc/wpasupplicant/README.Debian.gz
となります。困った場合はこちらも合わせてご参照下さい。

　以下に/etc/network/interfacesの定義について会場の例を記載します。

\begin{commandline}
$ sudo vi /etc/network/interfaces
-----以下のエントリがなければ追記ここから----------
iface wlan0_debian inet dhcp
     wpa-conf /etc/wpa_supplicant/wpa_supplicant_debian.conf
-----以下のエントリがなければ追記ここまで----------
$ sudo vi /etc/wpa_supplicant/wpa_supplicant_debian.conf
-----以下のエントリを追記ここから----------
network={
     ssid=<<会場のSSID>>
     psk=<<会場のパスワード>>
     scan_ssid=1
}
-----以下のエントリを追記ここまで----------
$ sudo chmod 600 /etc/wpa_supplicant/wpa_supplicant_debian.conf
$ sudo ifup wlan0=wlan0_debian
\end{commandline}
%$

 また、ハマってしまった時のデバッグ方法は、
/usr/share/doc/wpasupplicant/README.Debian.gz中の''4. Trubleshooting''の章が便利です。

 \subsection{その他の無線LAN用パッケージを利用の場合}

　すみません、自分が情報を持たないため、現場で教えて下さい。
 
\cleartooddpage

\vspace*{15cm}
\hrule
\vspace{2mm}
\includegraphics[width=2cm]{image200502/openlogo-nd.eps}
\noindent \Large \bf Debian 勉強会資料\\
\noindent \normalfont \debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日 \hspace{5mm}  初版第1刷発行\\
\noindent \normalfont 東京エリア Debian 勉強会 （編集・印刷・発行）\\
\hrule

\end{document}
