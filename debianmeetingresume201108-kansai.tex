%; whizzy chapter
% -initex iniptex -latex platex -format platex -bibtex jbibtex -fmt fmt
% 以上 whizzytex を使用する場合の設定.

%     Kansai Debian Meeting resources
%     Copyright (C) 2007 Takaya Yamashita
%     Thank you for Tokyo Debian Meeting resources

%     This program is free software; you can redistribute it and/or modify
%     it under the terms of the GNU General Public License as published by
%     the Free Software Foundation; either version 2 of the License, or
%     (at your option) any later version.

%     This program is distributed in the hope that it will be useful,
%     but WITHOUT ANY WARRANTY; without even the implied warranty of
%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.

%     You should have received a copy of the GNU General Public License
%     along with this program; if not, write to the Free Software
%     Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

%  preview (shell-command (concat "evince " (replace-regexp-in-string "tex$" "pdf"(buffer-file-name)) "&"))
% 画像ファイルを処理するためには ebb を利用して boundingbox を作成.
%(shell-command "cd image200708; ebb *.png")

%%ここからヘッダ開始.

\documentclass[mingoth,a4paper]{jsarticle}
\usepackage{kansaimonthlyreport}
\usepackage[dvips]{xy}
\usepackage{ascmac}

% 今回限りのコマンド
\definecolor{debianred}{rgb}{.780,.000,.211} % 199,0,54
\definecolor{debianblue}{rgb}{0,.208,.780} % 0,53,199
\definecolor{debianlightbackgroundblue}{rgb}{.941,.941,.957} % 240,240,244
\definecolor{debianbackgroundblue}{rgb}{.776,.784,.878} % 198,200,224
\definecolor{noir}{RGB}{3,3,36}
\definecolor{bleu}{RGB}{10,10,120}
\definecolor{bleuclair}{RGB}{17,17,150}
\definecolor{rouge}{RGB}{200,0,0}
\definecolor{jaune}{RGB}{255,255,0}
\definecolor{vert}{RGB}{0,255,0}
\definecolor{rougebg}{RGB}{160,0,0}
\definecolor{darkred}{rgb}{.7,0,0}
\newcommand{\textttc}[1]{\texttt{\color{rouge}#1}}
\newcommand{\textalert}[1]{{\color{darkred}{#1}}}
\usepackage{listings}
\lstset{basicstyle=\ttfamily}
\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing}
\newcommand{\seprule}{\vspace*{-0.5em}\centerline{\rule{\linewidth}{0.3pt}}\vspace*{-0.5em}}
% 今回限りのコマンド

% 日付を定義する, 毎月変わります.
\newcommand{\debmtgyear}{2011}
\newcommand{\debmtgmonth}{08}
\newcommand{\debmtgdate}{28}
\newcommand{\debmtgnumber}{50}

\begin{document}

\begin{titlepage}

% 毎月変更する部分, 本文の末尾も修正することをわすれずに

 第\debmtgnumber{}回 関西 Debian 勉強会資料

\vspace{2cm}

\begin{center}
\includegraphics{image200802/kansaidebianlogo.png}
\end{center}

\begin{flushright}
\hfill{}関西 Debian 勉強会担当者 佐々木・倉敷・のがた \\
\hfill{}\debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日
\end{flushright}

\thispagestyle{empty}
\end{titlepage}

\dancersection{Introduction}{Debian JP}

\subsection*{}%ロゴ用のスペース稼ぎ

関西 Debian 勉強会は Debian GNU/Linux のさまざまなトピック (新しいパッケー
ジ, Debian 特有の機能の仕組, Debian 界隈で起こった出来事, などなど) に
ついて話し合う会です.

目的として次の三つを考えています.
\begin{itemize}
      \item ML や掲示板ではなく, 直接顔を合わせる事での情報交換の促進
      \item 定期的に集まれる場所
      \item 資料の作成
\end{itemize}

それでは, 楽しい一時をお楽しみ下さい.

\clearpage

\begin{minipage}[b]{0.2\hsize}
 {\rotatebox{90}{\fontsize{80}{80}
{\gt 関西 Debian 勉強会}}}
\end{minipage}
\begin{minipage}[b]{0.8\hsize}
\hrule
\vspace{2mm}
\hrule
\setcounter{tocdepth}{1}
\tableofcontents
\vspace{2mm}
\hrule
\end{minipage}


\dancersection{最近の Debian 関係のイベント報告}{Debian JP}

\subsection{OSC 2011 Kyoto}

2011年7月16日(土)に京都リサーチパーク(KRP)でオープンソースカンファレンス2011京都が開
催されました。

\clearpage
%-------------------------------------------------------------------------------
\dancersection{事前課題}{Debian JP}

今回は以下の事前課題を設定しました。


Debian GNU/Linux unstable (sid) が使える環境を用意しておいて下さい。 普段お使いの環境が sid の場合には特に事前課題はありません。普段使いの環境が sid 以外の場合には、以下の方法が考えられます。

\begin{enumerate}

\item VirtualBox などの仮想マシン上に sid を install する
\item (c)debootstrap + schroot で sid 環境へ切り替えられるようにしておく
\item squeeze/wheezy を sid に upgrade する
\end{enumerate}

参加者の皆さんによる回答は以下の通りです。

\begin{prework}{ 佐々木洋平 }

今更(08/28 08:42) 申し込んでいないことに気がつく愚か者です。

普段から sid 使っています。 schroot もバリバリ。
\begin{commandline}
 $ ls -l /var/chroot
 drwxr-xr-x 22 root root 4096 2011-08-01 08:10 TeXLive-amd64/
 drwxr-xr-x 20 root root 4096 2011-07-14 11:07 lenny-i386/
 drwxr-xr-x 20 root root 4096 2011-07-14 11:07 lenny-amd64/
 drwxr-xr-x 20 root root 4096 2011-05-12 10:07 squeeze-i386/
 drwxr-xr-x 20 root root 4096 2011-05-12 10:07 squeeze-amd64/
 drwxr-xr-x 20 root root 4096 2011-08-14 18:07 sid-i386/
\end{commandline}
%$
\end{prework}

\begin{prework}{ 榎真治 }
(無回答)
\end{prework}

\begin{prework}{ gdevmjc }
久保です.お世話になります。

2. debootstrap + schroot で sid 環境を作ります。

debootstrap は完了。続いて schroot 勉強中。
\end{prework}

\begin{prework}{ 水野源 }

さて、Ubuntu 10.10上にどうやってsid環境作るかね…

\end{prework}

\begin{prework}{ murase\_syuka }

(無回答)

\end{prework}

\begin{prework}{ かわだてつたろう }

ラップトップでは sid 環境を使っています。
たまーに何かあるようですが、普通に使えています。
\end{prework}

\begin{prework}{ ojima.h }

(無回答)

\end{prework}

\begin{prework}{ 甲斐正三 }

持参するPCは事情によりSidにできないので、
今回はハンズオン無しでお話を伺うことになると思いますがよろしくお願いします。
（自宅のPCはホスト"amd64-stable"にkvm-qemuでゲスト"i686-sid"を入れています。）

\end{prework}

\begin{prework}{ Nao SATO }

debian 歴半年くらいです.普段は squeeze を使っている「なんちゃって」debian ユーザです.26日までには sid を使えるようにはしておくつもりです.

\end{prework}

\begin{prework}{ lurdan }

常用環境は sid です。ふつーに使えるよ sid。

\end{prework}

\begin{prework}{ kozo2 }

(無回答)

\end{prework}

\begin{prework}{ taksaeki }

手元の PC には元々一切 debian 環境がなかったので, パーティションを切り直し, 空いた領域に DVD を使って squeeze をインストールしました.
その後, 3 の方法 (upgrade) をとり, sid が使える環境を構築しました.

\end{prework}

\begin{prework}{ sxpxq619@yahoo.co.jp }

2. (c)debootstrap + schroot で sid へ切り替えられるようにする

の方法で, sid 環境を構築しました.

\end{prework}

\begin{prework}{ Y.YATSUO }

常用環境をwheezyからsidにdist-upgradeしました。
あっさりアップグレード完了し、今のところ問題無く使えてます。
今までsafe-upgradeするときはあまり内容を吟味せずにyしてしまっていたので今後は気をつけようと思います。

\end{prework}

\begin{prework}{ 山田 洋平 }

(c)debootstrap + schroot で sid へ切り替えられるようにして...みます。

\end{prework}

\begin{prework}{ よしだともひろ }

ノートPCに 2.(c)debootstrap + schrootでsidへ切り替えるようにしました。

自宅ではVirtualBoxにsidをinstallした環境がありますが、思った以上に普通に使えています。
\end{prework}

\begin{prework}{ KAWABATA Takuya }
{\bf{chroot を使ってホーム以下に sid 環境をつくる}}\newline
/home/takuya/chroot/sid 以下に chroot環境な sid を構築
\begin{commandline}
    $ sudo mkdir /home/takuya/chroot/sid
    $ sudo debootstrap sid /home/takuya/chroot/sid http://ftp.jp.debian.org/debian
\end{commandline}
%$
ログイン
\begin{commandline}
    $ sudo chroot /home/takuya/chroot/sid /bin/bash
\end{commandline}
%$

/home を共有する
\begin{commandline}
  $ sudo nano /etc/fstab
\end{commandline}
%$
以下を追記
\begin{commandline}
    /home /home/takuya/chroot/sid/home none bind 0 0
    /tmp  /home/takuya/chroot/sid/tmp none bind 0 0
    proc-chroot /home/takuya/chroot/sid/proc proc defaults 0 0
    devpts-chroot /home/takuya/chroot/sid/dev/pts devpts defaults 0 0
\end{commandline}
再起動

ユーザ情報のコピー
\begin{commandline}
    $ sudo cp /etc/passwd /home/takuya/chroot/sid/etc/
    $ sudo sed "s/\([^:]*\):[^:]*:/\1:*:/" /etc/shadow | sudo tee /home/takuya/chroot/sid/etc/shadow
\end{commandline}
%$$
sid に一般ユーザでログインできるようにする
\begin{commandline}
    $ echo "mychroot /home/takuya/chroot/sid" | sudo tee /etc/dchroot.conf
\end{commandline}
%$
\end{prework}

\begin{prework}{ 川江 }
KVMで仮想マシンにsidをインストールしていいですか？
\end{prework}

\begin{prework}{ 山下康成 }
sid ってなんですかぁ？？？（笑
\end{prework}

\clearpage
%------------------------------------------------------------------------------
\dancersection{モダンな Debian パッケージ作成入門}{佐々木洋平さん}

\subsection*{はじめに}
\label{sec-1}
\paragraph{このドキュメントについて}
\label{sec-1-1}


\begin{itemize}
\item このドキュメントは
  Lucas Nussbaum さんによる「Debian Packaging Tutorial」を元に佐々木が翻訳, 加筆修正したドキュメントです.
\item ライセンスは原文に合わせて GPL-3+, CC-BY-SA 3.0 とします.
\item 翻訳/加筆/修正作業中に間違いが混入しているかもしれませんが, その責は佐々木にあります.
\item お気付きの点などありましたら,
\begin{center}
uwabami@gfd-dennou.org
\end{center}

  まで, ご連絡下さいますよう, お願いします.
\end{itemize}
\paragraph{このチュートリアルについて}
\label{sec-1-2}

\begin{itemize}
\item 目的: \textalert{Debianパッケージ作成の必須知識の紹介}
\begin{itemize}
\item 既存のパッケージ修正
\item 独自パッケージの作成
\item Debianコミュニティとの交流方法
\item Debianのパワーユーザになる
\end{itemize}
\item 重要なポイントはカバーしています\ldots{}が完全ではありません
\begin{itemize}
\item もっとドキュメントを読む必要があるでしょう.
\end{itemize}
\item Debian派生ディストリビューションにも適用できます
\begin{itemize}
\item 例えば Ubuntu とか.
\end{itemize}
\end{itemize}
\paragraph{Debian とは?}
\label{sec-1-3}

\begin{itemize}
\item \textalert{GNU/Linux ディストリビューション}
\item GNU の精神に基いてオープン開発されている\newline
  最もメジャーなディストリビューション
\item \textalert{非商用}, 1000名以上のボランティアにより開発されている
\item 三つの大きな特徴
\begin{itemize}
\item \textalert{品質}: 技術的に洗練された文化
\begin{itemize}
\item 品質が充たされた時にリリースされる
\end{itemize}
\item \textalert{自由}: 開発者とユーザは\textalert{Debian 社会契約}により守られている
\begin{itemize}
\item 1993 年の開発当初から, フリーソフトウェアの文化を促進
\end{itemize}
\item \textalert{主体性}: どの企業の傘にも入っていない
\begin{itemize}
\item 参加者の自主性. 民主的. 議決プロセスは全て公開.
\end{itemize}
\end{itemize}
\item 最良の意味での\textalert{愛好家達}: これらは \textalert{愛}によってなされている
\end{itemize}
\paragraph{Debian パッケージ}
\label{sec-1-4}

\begin{itemize}
\item \textalert{.deb} ファイル(バイナリパッケージ)
\item ユーザにソフトウェアを配布する強力で便利な手段
\item 最も一般的な二つのパッケージフォーマットの一つ(他には RPM がある)
\item 高い普遍性:
\begin{itemize}
\item 30,000 以上のバイナリパッケージが Debian には存在\newline
    $\rightarrow$ 殆どのフリーソフトウェアは Debian に含まれている
\item 12 アーキテクチャ, 2 つの Linux 以外のカーネルへの移植
\begin{itemize}
\item i386, amd64, IA64, ppc, armel, \ldots{}
\item Debian GNU/Hurd, Debian GNU/KFreeBSD
\end{itemize}
\item 120 以上の Debian 派生ディストリビューション
\end{itemize}
\end{itemize}
\paragraph{Deb パッケージのフォーマット}
\label{sec-1-5}

\begin{itemize}
\item \texttt{.deb} ファイル: \texttt{ar} アーカイブ
\end{itemize}
    \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
$ ar tv wget_1.12-2.1_i386.deb
rw-r--r-- 0/0      4 Sep  5 15:43 2010 debian-binary
rw-r--r-- 0/0   2403 Sep  5 15:43 2010 control.tar.gz
rw-r--r-- 0/0 751613 Sep  5 15:43 2010 data.tar.gz
    \end{lstlisting}
\begin{itemize}
\item \texttt{debian-binary}: deb ファイルの形式が記述されている.\newline
    現在は version 2.0
\item \texttt{control.tar.gz}: パッケージのメタデータ
\item \texttt{data.tar.gz}: パッケージのデータそのもの
\item この \texttt{.deb} ファイルを手で作成することも可能
\end{itemize}
\begin{center}\vspace{-0.5\baselineskip}
  {\footnotesize \url{http://tldp.org/HOWTO/html\_single/Debian-Binary-Package-Building-HOWTO/}}
\end{center}\vspace{-0.5\baselineskip}
\begin{itemize}
\item けれども殆どの人はそうしない
\end{itemize}
\begin{center}
本チュートリアル: \textalert{Debianパッケージを Debian の流儀で作成}
\end{center}
\paragraph{必要なツールたち}
\label{sec-1-6}

\begin{itemize}
\item root 権限のあるDebian(もしくはUbuntu)システム
\item 幾つかのパッケージ
\begin{itemize}
\item \textalert{build-essential}:
    パッケージ作成環境にインストールされていることが前提となっている
    メタパッケージ.
\begin{itemize}
\item メタパッケージ: 他のパッケージに依存するだけのパッケージ
\item libc-dev, gcc, g++, make など
\item \textalert{dpkg-dev}: Debian 固有のパッケージ作成ツールを含む
\item このパッケージは control ファイルの \texttt{Build-Depends:}に書かない
\end{itemize}
\item \textalert{devscripts}: Debian のメンテナにとって有用な多くのスクリプト
\end{itemize}
\item ほかにも, これ以降で触れる幾つかのパッケージがあると便利.
\begin{itemize}
\item 例えば \textalert{debhelper}, \textalert{cdbs}, \textalert{quilt},
    \textalert{pbuilder}, \textalert{sbuild}, \textalert{lintian},
    \textalert{svn-buildpackage}, \textalert{git-buildpackage}, \ldots{}
\item 必要に応じてインストールすると良い
\end{itemize}
\item 上記を一括インストールする\textalert{packaging-dev}というメタパッケージもある
\end{itemize}
\paragraph{一般的なパッケージ作成の流れ}
\label{sec-1-7}

  \begin{center}
    \begin{tikzpicture}[
      node1/.style={shape=rectangle,draw=rouge,fill=debianbackgroundblue,thick},
      arr/.style={very thick}, command/.style={text=rouge,font=\ttfamily}, ]
      %\pgfsetarrows{latex-stealth};
      \pgfsetarrows{-to};
      \node[node1] (www) at (0, 0) {Web};
      \node[node1] (us) at (2.5, 0) {上流のソース};
      \node[node1] (da) at (-2.5, 0) {Debianミラー};
      \node[node1] (sp) at (0, -2) {ソースパッケージ};
      \pgfsetarrows{to-};
      \draw[arr,<-,dashed,thick] (sp) -- (2.5,-2) node[right=0cm,text width=2.98cm,text centered,font=\small\sl] {手を動かす作業のほとんどはココで};
      \node[node1] (bin) at (0, -4) {一つ or 複数のバイナリパッケージ};
      \draw[arr,<-,dashed,thick] (bin) -- (3.5,-4) node[right,text centered,font=\small\ttfamily\sl] {.deb\normalfont};
      \pgfsetarrows{-to};
      \draw[arr,->] (us) -- (sp) node[pos=0.5,right,command] {dh\_make};
      \draw[arr,->] (da) -- (sp) node[pos=0.5,left,command] {apt-get source};
      \draw[arr,->] (www) -- (sp) node[pos=0.5,left,command] {dget};
      \draw[arr,->] (sp) -- (bin) node[pos=0.5,right,text width=6.5cm] {\textttc{debuild}(ビルドと\textttc{lintian}によるテスト) or \textttc{dpkg-buildpackage}};
      \draw[arr,->] (bin) -- (1,-6) node[pos=0.5,right] {インストール: (\textttc{debi})};
      \draw[transparent] (bin) -- (-1,-6) node[pos=0.5,left,opaque] {アップロード: (\textttc{dput})};
      \draw[arr,->,rounded corners] (bin) -- (-1,-6) -- (-4.5,-6) -- (-4.5,0) -- (da);
      \useasboundingbox (-4,-6) rectangle (6,0); % hack hack hack
    \end{tikzpicture}
  \end{center}
\paragraph{例: dash の再構築}
\label{sec-1-8}

\begin{enumerate}
\item build-essential, devscripts,  debhelperのインストール
   \begin{verbatim}
sudo apt-get install build-essential devscripts debhelper
   \end{verbatim}
   \vspace{-1\baselineskip}
\item 作業ディレクトリの作成, 移動
   \begin{verbatim}
$ mkdir /tmp/debian-tutorial ; cd /tmp/debian-tutorial
   \end{verbatim}
   \vspace{-1\baselineskip}
\item \texttt{dash}のソースパッケージの取得\newline
   (\texttt{/etc/apt/sources.list} に \texttt{deb-src} の行が必要)
   \begin{verbatim}
$ apt-get source dash
   \end{verbatim}
   \vspace{-1\baselineskip}
\item パッケージの作成
   \begin{verbatim}
$ cd dash-*
$ debuild -us -uc
   \end{verbatim}
   \vspace{-1\baselineskip}
\item ちゃんとできたか確認
\begin{itemize}
\item 上位ディレクトリに \texttt{.deb} ファイルができているか確認
\end{itemize}
\item \texttt{debian/} 以下を見てみよう
\begin{itemize}
\item パッケージ作成時にやった事が残っている
\end{itemize}
\end{enumerate}
\subsection*{ソースパッケージの作成}
\label{sec-2}
\paragraph{ソースパッケージとは}
\label{sec-2-1}

\begin{itemize}
\item 一つのソースパッケージがら幾つかのバイナリパッケージを生成\newline
  例: \texttt{libtar} ソースパッケージ→ \texttt{libtar0}, \texttt{libtar-dev} バイナリパッケージ
\item 二種類のソースパッケージ
\begin{itemize}
\item Native パッケージ: Debian固有のソフトウェア(\texttt{dpkg},\texttt{apt})
\item Non-Native パッケージ: Debian 以外で開発されたソフトウェア
\end{itemize}
\item メインファイル: \textalert{\texttt{.dsc}} (メタデータ)
\item それ以外のファイル:
\begin{itemize}
\item 1.0-native: \texttt{package\_version.tar.gz}
\item 1.0-non-native:
\begin{itemize}
\item \texttt{pkg\_ver.orig.tar.gz}: 上流(upstream)のソース
\item \texttt{pkg\_debver.diff.gz}: Debianでの変更をまとめたパッチ
\end{itemize}
\item 3.0(quilt):
\begin{itemize}
\item \texttt{pkg\_ver.orig.tar.gz}: 上流(upstream)のソース
\item \texttt{pkg\_debver.debian.tar.gz}: Debianでの変更をまとめたtarball
\end{itemize}
\end{itemize}
\end{itemize}

(詳細は \texttt{dpkg-source(1)} を参照)
\paragraph{ソースパッケージの例(wget\_1.12-2.1.dsc)}
\label{sec-2-2}

  \begin{lstlisting}[basicstyle=\ttfamily\small]
Format: 3.0 (quilt)
Source: wget
Binary: wget
Architecture: any
Version: 1.12-2.1
Maintainer: Noel Kothe <noel@debian.org>
Homepage: http://www.gnu.org/software/wget/
Standards-Version: 3.8.4
Build-Depends: debhelper (>> 5.0.0), gettext, texinfo,
 libssl-dev (>= 0.9.8), dpatch, info2man
Checksums-Sha1:
 50d4ed2441e67[..]1ee0e94248 2464747 wget_1.12.orig.tar.gz
 d4c1c8bbe431d[..]dd7cef3611 48308 wget_1.12-2.1.debian.tar.gz
Checksums-Sha256:
 7578ed0974e12[..]dcba65b572 2464747 wget_1.12.orig.tar.gz
 1e9b0c4c00eae[..]89c402ad78 48308 wget_1.12-2.1.debian.tar.gz
Files:
 141461b9c04e4[..]9d1f2abf83 2464747 wget_1.12.orig.tar.gz
 e93123c934e3c[..]2f380278c2 48308 wget_1.12-2.1.debian.tar.gz
\end{lstlisting}
\paragraph{ソースパッケージの取得}
\label{sec-2-3}

\begin{itemize}
\item Debian のアーカイブから取得する場合:
\begin{itemize}
\item \texttt{apt-get source \textsl{package}}
\item \texttt{apt-get source \textsl{package=version}}
\item \texttt{apt-get source \textsl{package/release}}\newline
    \texttt{sources.list} に \texttt{deb-src} の行が必要
\end{itemize}
\item インターネットから取得する場合:
\begin{itemize}
\item \texttt{dget \textsl{url of .dsc}}
    \item \texttt{dget http://snapshot.debian.org/archive/debian-archive/\\20090802T004153Z/debian/dists/bo/main/source/web/\\
wget\_1.4.4-6.dsc}\newline
      (\href{http://snapshot.debian.org/}{\ttfamily snapshot.d.o}: 2005 年からの全Debianパッケージを提供)
\end{itemize}
\item VCS からの取得(宣言されていれば)
\begin{itemize}
\item \texttt{debcheckout \textsl{package}}
\end{itemize}
\item 取得したら, \texttt{dpkg-source -x \textsl{file.dsc}} で展開
\end{itemize}
\paragraph{基本となるソースパッケージの作成}
\label{sec-2-4}

\begin{itemize}
\item upstream source の取得
\begin{itemize}
\item \textsl{upstream source} = ソフトウェアの元々の開発者の配布物
\end{itemize}
\item リネーム: \texttt{<\textsl{source\_package}>\_<\textsl{upstream\_version}>.orig.tar.gz}
\begin{itemize}
\item 例: \texttt{simgrid-3.6.tar.gz} → \texttt{simgrid\_3.6.orig.tar.gz}
\end{itemize}
\item 展開
\item \texttt{cd \textsl{upstream\_source} \&\& dh\_make}
\begin{itemize}
\item \texttt{dh\_make} は \textalert{dh-make} パッケージに含まれている
\item \texttt{dh\_make} の代わりに \texttt{dh-make-perl}, \texttt{dh-make-php}, \texttt{gem2deb}, \ldots{}
\end{itemize}
\item \texttt{debian/} ディレクトリが作成され, 雛形が展開される
\end{itemize}
\paragraph{\ttfamily{debian/} 以下のファイルたち}
\label{sec-2-5}

パッケージ作成作業は全て\texttt{debian/} 以下のファイルを修正して行なう
\begin{itemize}
\item メインファイル:
\begin{itemize}
\item \textalert{control}: パッケージのメタデータ(依存関係などを記述\}
\item \textalert{rules}: パッケージを作成する方法を記述
\item \textalert{copyright}: パッケージの copyright, license を記述
\item \textalert{changelog}: Debian パッケージの changelog
\end{itemize}
\item その他:
\begin{itemize}
\item compat
\item watch
\item dh\_ 用のファイル: *.dirs, *.docs, *.manpages, \ldots{}
\item メンテナスクリプト: *.postinst, *.prerm, \ldots{}
\item source/format
\item patches/ : upstream source を修正する場合
\end{itemize}
\item それぞれのファイルは RFC 822(mail headers) で記述
\end{itemize}
\paragraph{\ttfamily{debian/changelog}}
\label{sec-2-6}

\begin{itemize}
\item Debian パッケージの変更点を列挙
\item パッケージの現在のバージョンを明記
\end{itemize}
\begin{center}
\begin{tikzpicture}
  \draw (0,0) node[above right] {\large 1.2.1.1-5};
  \draw [decorate,decoration={brace}] (2,0) -- (1.45,0) node[at start,below,text width=1.6cm,text centered] {\small  Debian revision};
  \draw [decorate,decoration={brace}] (1.4,0) -- (0,0) node[midway,below,text width=1.6cm,text centered] { \small Upstream version};
\end{tikzpicture}
\end{center}
\begin{itemize}
\item 手で修正するか \texttt{dch} コマンドを使用する
\item Debian もしくは Ubuntu の Bug を close する特別な書式\newline
  Debian: \texttt{Closes:~\#595268}; Ubuntu: \texttt{LP:~\#616929}
\end{itemize}
  \seprule
  \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
mpich2 (1.2.1.1-5) unstable; urgency=low

  * Use /usr/bin/python instead of /usr/bin/python2.5. Allow
    to drop dependency on python2.5.  Closes: #595268
  * Make /usr/bin/mpdroot setuid. This is the default after
    the installation of mpich2 from source, too. LP: #616929
    + Add corresponding lintian override.

 -- Lucas Nussbaum <lucas@debian.org>  Wed, 15 Sep 2010 18:13:44 +0200
\end{lstlisting}
\paragraph{\ttfamily{debian/control}}
\label{sec-2-7}

\begin{itemize}
\item パッケージのメタデータ
\begin{itemize}
\item ソースパッケージ本体
\item 作成するバイナリパッケージ全て
\end{itemize}
\item Package name, section, priority, maintainer, uploaders,
  build-dependencies, dependencies, description, homepage, \ldots{}
\item Debian ポリシー 第 5 章参照:\newline
  \href{http://www.debian.org/doc/debian-policy/ch-controlfields.html}{http://www.debian.org/doc/debian-policy/ch-controlfields.html}
\end{itemize}
  \seprule
\begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
Source: wget
Section: web
Priority: important
Maintainer: Noel Kothe <noel@debian.org>
Build-Depends: debhelper (>> 5.0.0), gettext, texinfo,
 libssl-dev (>= 0.9.8), dpatch, info2man
Standards-Version: 3.8.4
Homepage: http://www.gnu.org/software/wget/

Package: wget
Architecture: any
Depends: ${shlibs:Depends}, ${misc:Depends}
Description: retrieves files from the web
 Wget is a network utility to retrieve files from the Web
\end{lstlisting}
\paragraph{Architecture: all or any}
\label{sec-2-8}

二種類のバイナリパッケージ
\begin{itemize}
\item アーキテクチャ毎に内容が異なるパッケージ
\begin{itemize}
\item 例: C プログラム
\item \texttt{debian/control} では \texttt{Architecture: any}
\begin{itemize}
\item もしくは, アーキテクチャのサブセット毎に指定:\newline
      \texttt{Architecture:\ amd64 i386 ia64 hurd-i386}
\end{itemize}
\item \texttt{buildd.debian.org}でアップロードしたアーキテクチャ以外についてパッケージを作成
\item パッケージ名: \texttt{\textsl{package}\_\textsl{version}\_\textsl{architecture}.deb}
\end{itemize}
\item アーキテクチャによらず中身が同じパッケージ
\begin{itemize}
\item 例: Perl ライブラリ
\item \texttt{debian/control} では \texttt{Architecture: all}
\item パッケージ名: \texttt{\textsl{package}\_\textsl{version}\_\textbf{all}.deb}
\end{itemize}
\end{itemize}
一つのソースパッケージから, 複数の
  \texttt{Architecture:\ any} と
  \texttt{Architecture:\ all} のバイナリパッケージを生成することが可能
\paragraph{\ttfamily{debian/rules}}
\label{sec-2-9}

\begin{itemize}
\item Makefile
\item Debianパッケージを作成する interface
\item Debian ポリシーの 第4章 8 節 参照
  {\small \texttt{http://www.debian.org/doc/debian-policy/ch-source.html\#s-debianrules}}
\item 5 つの必須ターゲット:
\begin{itemize}
\item \texttt{build}: パッケージの設定と構築を実行
\item \texttt{binary, binary-arch, binary-indep}: バイナリパッケージの作成
\begin{itemize}
\item \texttt{dpkg-buildpackage} は
      \texttt{binary} を全てのパッケージについて,
      \texttt{binary-arch} を \texttt{Architecture: any} のパッケージについて
      それぞれ実行
\end{itemize}
\item \texttt{clean}: ソースディレクトリの clean up
\end{itemize}
\end{itemize}
\paragraph{パッケージ作成支援}
\label{sec-2-10}

\begin{itemize}
\item \texttt{debian/rules} に shell スクリプトを直接記述可能
\begin{itemize}
\item 例: \texttt{adduser} パッケージ
\end{itemize}
\item 良い方法: \textsl{Packaging helper} の使用
\item 良く使われるのは \textbf{debhelper} (パッケージの 98\% で使用中)
\item 目的:
\begin{itemize}
\item 全てのパッケージで使用される標準的なツールの呼出しを共通化
\item パッケージ作成時のバグをしっかりと修正\newline
    {\footnotesize
    dh\_installdirs, dh\_installchangelogs, dh\_installdocs,
    dh\_installexamples, dh\_install, dh\_installdebconf, dh\_installinit,
    dh\_link, dh\_strip, dh\_compress, dh\_fixperms, dh\_perl,
    dh\_makeshlibs, dh\_installdeb, dh\_shlibdeps, dh\_gencontrol,
    dh\_md5sums, dh\_builddeb,} ...
\item \texttt{debian/rules} でこれらを呼ぶ
\item \texttt{debian/} 以下にファイルを置いて設定する\newline
    {\footnotesize
    \ttfamily dirs, \textsl{package}.docs, \textsl{package}.examples,
    \textsl{package}.install, \textsl{package}.manpages }...
\item Third-party ヘルパーもある: \textalert{python-support}, \textalert{dh\_ocaml} \ldots{}
\item \texttt{debian/compat}: debhelper の適用するバージョン(``7'' を使おう)
\end{itemize}
\end{itemize}
\paragraph{\ttfamily{debian/rules} using debhelper(1/2)}
\label{sec-2-11}

  \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
#!/usr/bin/make -f

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

build:
        $(MAKE)
        #docbook-to-man debian/packagename.sgml > packagename.1

clean:
        dh_testdir
        dh_testroot
        rm -f build-stamp configure-stamp
        $(MAKE) clean
        dh_clean

install: build
        dh_testdir
        dh_testroot
        dh_clean -k
        dh_installdirs
        # Add here commands to install the package into debian/packagename.
        $(MAKE) DESTDIR=$(CURDIR)/debian/packagename install
\end{lstlisting}
\paragraph{\ttfamily{debian/rules} using debhelper(2/2)}
\label{sec-2-12}

  \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]

# Build architecture-independent files here.
binary-indep: build install

# Build architecture-dependent files here.
binary-arch: build install
        dh_testdir
        dh_testroot
        dh_installchangelogs
        dh_installdocs
        dh_installexamples
        dh_install
        dh_installman
        dh_link
        dh_strip
        dh_compress
        dh_fixperms
        dh_installdeb
        dh_shlibdeps
        dh_gencontrol
        dh_md5sums
        dh_builddeb

binary: binary-indep binary-arch
.PHONY: build clean binary-indep binary-arch binary install configure
\end{lstlisting}
\paragraph{CDBS}
\label{sec-2-13}

\begin{itemize}
\item \texttt{debhelper} を用いてもそれなりに冗長
\item 共通の機能に分けた二段目の helper がある
\begin{itemize}
\item \texttt{./configure \&\& make \&\& make install} や CMake
\item Perl, Python, Ruby, GNOME, KDE, Java, Haskel, \ldots{}
\end{itemize}
\item CDBS
\begin{itemize}
\item 2005 年に導入. \textsl{GNU make} による処方箋
\item ドキュメント: \texttt{/usr/share/doc/cdbs/}
\item しかしながら, これを嫌う開発者もいる
\begin{itemize}
\item パッケージをカスタマイズして構築するのが困難:\\
``\textsl{twisty maze of makefiles and environment variables}''
\item 素の debhelper に比べて遅い(不要な \texttt{dh\_*} の呼び出しが多い)
\end{itemize}
\end{itemize}
\end{itemize}
  \seprule
      \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
#!/usr/bin/make -f
include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/autotools.mk

# add an action after the build
build/mypackage::
    /bin/bash debian/scripts/foo.sh
      \end{lstlisting}
\paragraph{Dh (a.k.a Debhelper 7, or dh7)}
\label{sec-2-14}

\begin{itemize}
\item 2008 年に \textsl{CDBS killer} として導入
\item \textalert{dh} コマンドは \texttt{dh\_*} を呼び出す
\item \textsl{debian/rules} に必要なのは overrides のみ
\item CDBS に比べてカスタマイズが容易
\item ドキュメント:man (\texttt{debhelper(7)}, \texttt{dh(1)}), DebConf9 での発表スライド\\
\href{http://kitenet.net/~joey/talks/debhelper/debhelper-slides.pdf}{http://kitenet.net/\~joey/talks/debhelper/debhelper-slides.pdf}
\end{itemize}
  \seprule
    \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
#!/usr/bin/make -f
%:
    dh $@

override_dh_auto_configure:
     dh_auto_configure -- --with-kitchen-sink

override_dh_auto_build:
     make world

    \end{lstlisting}%$
\paragraph{classic debhelper v.s. CDBS v.s. dh}
\label{sec-2-15}

\begin{itemize}
\item 現状の使用率:
\begin{itemize}
\item classic debhelper: 41\% \hskip 1em CDBS: 23\% \hskip 1em  dh: 34\%
\end{itemize}
\item どれを学ぶべきか?
\begin{itemize}
\item 多分全部をそれなりに
\item dh もしくは CDBS を使う場合には debhelper の知識が必要
\item CDBS を使っているパッケージを修正する必要がある
\end{itemize}
\item 新しいパッケージにはどれを使うべきか?
\begin{itemize}
\item \textalert{dh} (多分これから増えていく)
\end{itemize}
\end{itemize}
\begin{center}
\includegraphics[width=9cm]{image201108/debhelper-cdbs-dh.png}
\end{center}

%  \begin{center}
%    \begin{tikzpicture}
%\begin{axis}[small,label style={font=\footnotesize},xlabel={\small Time},ylabel={\small 使用率 (\%)},
%   date coordinates in=x,height=4.85cm,width=9cm,xticklabel={\month/\year},
%        legend style={font=\footnotesize,at={(1.02,1)},anchor=north west},max space between ticks=82,try min ticks=5,ymin=0]
%   \addplot[mark=none,blue,thick,style=densely dotted] table[x=date,y=dh] {cdbs-dh7.txt};
%   \addplot[mark=none,red,thick,style=dashed] table[x=date,y=dh7] {cdbs-dh7.txt};
%   \addplot[mark=none,green,thick] table[x=date,y=cdbs] {cdbs-dh7.txt};
%   \legend{debhelper, dh, CDBS}
%\end{axis}
%\end{tikzpicture}
%\end{center}
\subsection*{パッケージの構築, テスト}
\label{sec-3}
\paragraph{パッケージの構築}
\label{sec-3-1}

\begin{itemize}
\item \texttt{apt-get build-dep mypackage}\newline
  \texttt{Build-Depends} にあるパッケージをインストールする
\item \texttt{debuild}: パッケージの構築, \texttt{lintian} によるチェック, GPG サイン
\begin{itemize}
\item もしくは \texttt{dpkg-buildpackage -us -uc} を直接実行
\end{itemize}
\item パッケージはクリーンかつ最小構成の環境でテストするのが良い
\begin{itemize}
\item \texttt{pbuilder}: \textsl{chroot} 環境下でパッケージをビルドするヘルパー\newline
    良いドキュメント: \href{https://wiki.ubuntu.com/PbuilderHowto}{https://wiki.ubuntu.com/PbuilderHowto} \newline
    (\textttc{cowbuilder}, \textttc{ccache}, \textttc{distcc} による最適化など)
\item \texttt{schroot} と \texttt{sbuild}: Debian の build daemon で使用\newline
    (\texttt{pbuilder}ほどシンプルではないけれど LVM snapshot が使えたりする\newline
    ドキュメント: \href{https://help.ubuntu.com/community/SbuildLVMHowto}{https://help.ubuntu.com/community/SbuildLVMHowto})
\end{itemize}
\item \texttt{.deb} ファイルと \texttt{.changes} ファイルを生成する
\begin{itemize}
\item \texttt{.changes}: 何を生成したのかが記述される. upload 時に使用する
\end{itemize}
\end{itemize}
\paragraph{パッケージのインストール, テスト}
\label{sec-3-2}

\begin{itemize}
\item ローカルにインストールする: \textttc{debi}\newline
  \texttt{.changes} ファイルを使用して何をインストールしたか確認
\item パッケージの中身の確認: \texttt{debc ../mypacakge<TAB>.changes}
\item 以前のバージョンとの比較: \newline
  \texttt{debdiff ../mypackage\_1\_*.changes ../mypackage\_2\_*.changes} \newline
  ソースパッケージの比較は \newline
  \texttt{debdiff ../mypackage\_1\_*.dsc ../mypackage\_2\_*.dsc}
\item \texttt{lintian} によるチェック:
  \texttt{lintian -i ../mypackage<TAB>.changes}\newline
  \texttt{lintian -i}: エラーについて詳細に情報を提供
\item Debian へパッケージをアップロード: \textttc{dput}
\item 個人的なパッケージリポジトリの作成: \textttc{reprepro}\newline
  ドキュメント: \href{http://mirror.alioth.debian.org}{http://mirror.alioth.debian.org}
\end{itemize}
\subsection*{実習1: grep パッケージの修正}
\label{sec-4}
\paragraph{実習1: grep パッケージの修正}
\label{sec-4-1}

\begin{itemize}
\item \href{http://ftp.jp.debian.org/debian/pool/main/g/grep/}{http://ftp.jp.debian.org/debian/pool/main/g/grep/} から 2.6.3-3 を取得
\item 展開して \texttt{debian/} 以下を見てみよう
\begin{itemize}
\item 幾つのバイナリパッケージが生成されていますか?
\item どのパッケージヘルパーが使用されていますか?
\end{itemize}
\item パッケージの作成
\item パッケージの修正: chengelog のエントリを一個増やしてみよう!
\item \texttt{./configure} で perl-regexp support を無効化してみよう
\item パッケージの再構築
\item debdiff でオリジナルと新しいパッケージの比較してみよう
\item 新しく作成したパッケージをインストールしてみよう
\end{itemize}

疑問/質問などあったら直ぐに言って下さい.
\subsection*{一歩進んだ話題}
\label{sec-5}
\paragraph{\ttfamily{debian/copyright}}
\label{sec-5-1}

\begin{itemize}
\item ソースとパッケージに関する Copyright とライセンスの情報
\item 伝統的には単なる text で記述
\item 新: machine-readble format の策定: \href{http://dep.debian.net/deps/dep5/}{http://dep.debian.net/deps/dep5/}
\end{itemize}
  \seprule
  \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
Format: <VERSIONED_FORMAT_URL>
Upstream-Name: X Solitaire
Source: ftp://ftp.example.com/pub/games

Files: *
Copyright: Copyright 1998 John Doe <jdoe@example.com>
License: GPL-2+
 This program is free software; you can redistribute it
 [...]
 .
 On Debian systems, the full text of the GNU General Public
 License version 2 can be found in the file
 `/usr/share/common-licenses/GPL-2'.

Files: debian/*
Copyright: Copyright 1998 Jane Smith <jsmith@example.net>
License:
 [LICENSE TEXT]
\end{lstlisting}
\paragraph{上流のソースの修正}
\label{sec-5-2}

\begin{itemize}
\item 頻繁に行なわれている
\begin{itemize}
\item バグ修正, Debian 固有のカスタマイズ
\item 新しい upstream release からの backport
\end{itemize}
\item 幾つかの方法がある
\begin{itemize}
\item ファイルを直接修正する
\begin{itemize}
\item これは simple
\item しかしながら, 変更点の追跡や文書化ができない
\end{itemize}
\item patch システム
\begin{itemize}
\item upstream への貢献
\item 派生ディストリビューションとの変更点の共有
\item 変更点を明らかに\newline
      \href{http://patch-tracker.debian.org/}{http://patch-tracker.debian.org/}
\end{itemize}
\end{itemize}
\end{itemize}
\paragraph{Patch システム}
\label{sec-5-3}

\begin{itemize}
\item 原則: 変更点はパッチとして \texttt{debian/patches/} に置く
\item 構築時に適用したり外したりする
\item これまでは: 幾つかの実装\newline
  \textsl{simple-patchsys}(\textsl{cdbs}),
  \textsl{dpatch}, \textttc{\textsl{quilt}}
\item これらは全て二つの \texttt{debian/rules} のターゲットをサポート:
\begin{itemize}
\item \texttt{debian/rules patch}: 全てのパッチを適用
\item \texttt{debian/rules unpatch}: 全てのパッチを外す
\end{itemize}
\item さらなるドキュメント: \href{http://wiki.debian.org/debian/patches}{http://wiki.debian.org/debian/patches}
\item \textalert{パッチシステム入りの新しいソースフォーマット: 3.0 (quilt)}
\begin{itemize}
\item これからの推奨される方法
\item \textsl{quilt} について知る必要がある\newline
    \href{http://pkg-perl.alioth.debian.org/howtow/quilt.html}{http://pkg-perl.alioth.debian.org/howtow/quilt.html}
\end{itemize}
\end{itemize}
\paragraph{Patch に関するドキュメント}
\label{sec-5-4}

\begin{itemize}
\item パッチの先頭に標準的なヘッダとして記述
\item Patch Tagging Guideline: \href{http://deb.debian.net/deps/dep3/}{http://deb.debian.net/deps/dep3/}
\item 全てのパッチは \href{http://patch-tracker.debian.org}{http://patch-tracker.debian.org} にて公開されている
\end{itemize}
\seprule
  \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
Description: Fix widget frobnication speeds
        Frobnicating widgets too quickly tended to cause explosions.
Forwarded: http://lists.example.com/2010/03/1234.html
Author: John Doe <johndoe-guest@users.alioth.debian.org>
Applied-Upstream: 1.2, http://bzr.foo.com/frobnicator/revision/123
Last-Update: 2010-03-29

--- a/src/widgets.c
+++ b/src/widgets.c
@@ -101,9 +101,6 @@ struct {
\end{lstlisting}
\paragraph{インストール/リムーブ時に何かを行なうには?}
\label{sec-5-5}

\begin{itemize}
\item パッケージを展開するだけでは不十分な時がある
\item システムユーザを作成/削除したり, サービスを開始/停止させたり, \textsl{alternatives} を管理したり
\item これらは \textsl{メンテナスクリプト} で行なう\newline
  \texttt{preinst, postinst, prerm, postrm}
\begin{itemize}
\item 共通の動作に関する snippet は debhelper で生成される
\end{itemize}
\item ドキュメント: Debian Policy, 第6章\\
{\footnotesize \url{http://www.debian.org/doc/debian-policy/ch-maintainerscripts.html}} \newline
\item ドキュメント: Debian Developer's Reference, 第6章 4 節\\
{\scriptsize \url{http://www.debian.org/doc/developers-reference/best-pkging-practices.html}} \newline
  {\footnotesize \url{http://people.debian.org/~srivasta/MaintainerScripts.html}}
\item ユーザへのプロンプトの表示
\begin{itemize}
\item \textalert{debconf} で行なう
\item ドキュメント: \texttt{debconf-devel(7)} (\texttt{debconf-doc} package)
\end{itemize}
\end{itemize}
\paragraph{upstream のバージョン監視}
\label{sec-5-6}

\begin{itemize}
\item \texttt{debian/watch} に記述しておく (\texttt{uscan(1)} を参照)
\end{itemize}
    \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
version=3
http://tmrc.mit.edu/mirror/twisted/Twisted/(\d\.\d)/ \
  Twisted-([\d\.]*)\.tar\.bz2
    \end{lstlisting}
\begin{itemize}
\item \texttt{debian/watch} を使用して監視する Debian のインフラ:\newline
  \href{http://dehs.alioth.debian.org}{http://dehs.alioth.debian.org}
\item Package Tracking System からのメンテナへメールによる通知:\newline
  \href{http://packages.qa.debian.org/}{http://packages.qa.debian.org/}
\item \texttt{uscan}: 手動チェック
\item \texttt{uupdate}: 最新の upstream ソースを用いて自動アップデートを試みる
\end{itemize}
\paragraph{VCS(e.g. SVN, Git) を用いたパッケージング}
\label{sec-5-7}

\begin{itemize}
\item ブランチやタグ付けなど, パッケージ作成作業を助ける幾つかのツール:\newline
    \texttt{svn-buildpackage}, \texttt{git-buildpackage}
\item 例: \texttt{git-buildpackage}
\begin{itemize}
\item \texttt{upstream} branch to track upstream with \texttt{upstream/\textsl{version}} tags
\item \texttt{master} branch tracks the Debian package
\item \texttt{debian/\textsl{version}} tags for each upload
\item \texttt{pristine-tar} branch to be able to rebuild the upstream tarball
\end{itemize}
\item \texttt{debian/control} 内の \texttt{Vcs-*} fields でリポジトリの場所を記述
\begin{itemize}
\item \href{http://wiki.debian.org/Alioth/Git}{http://wiki.debian.org/Alioth/Git}
\item \href{http://wiki.debian.org/Alioth/Svn}{http://wiki.debian.org/Alioth/Svn}
\end{itemize}
\end{itemize}
  \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
Vcs-Browser: http://git.debian.org/?p=devscripts/devscripts.git
Vcs-Git: git://git.debian.org/devscripts/devscripts.git
  \end{lstlisting}
  \begin{lstlisting}[basicstyle=\ttfamily\footnotesize]
Vcs-Browser: http://svn.debian.org/viewsvn/pkg-perl/trunk/libwww-perl/
Vcs-Svn: svn://svn.debian.org/pkg-perl/trunk/libwww-perl
  \end{lstlisting}
\begin{itemize}
\item VCS とのやりとり: \texttt{debcheckout}, \texttt{debcommit}
\begin{itemize}
\item \texttt{debcheckout grep} $\rightarrow$ checks out the source package from Git
\end{itemize}
\end{itemize}
\subsection*{Debian パッケージのメンテナンス}
\label{sec-6}
\paragraph{Debian に貢献する幾つかの方法}
\label{sec-6-1}

\begin{itemize}
\item もっとも良くない方法:
\begin{itemize}
\item 独自ソフトウェアをパッケージング
\item それをDebianに入れる
\item トンズラこく
\end{itemize}
\item 現在メンテされていないパッケージ((\textsl{orphaned packages})をひきとる
\begin{itemize}
\item Debian にはメンテされていない多くのパッケージがある
\item あなたが普段使用しているパッケージがそうかもしれない!
\end{itemize}
\item パッケージングチームに参加しよう
\begin{itemize}
\item パッケージングにフォーカスした幾つものチームがある. 助けを必要としている
\item 現在のチームの一覧: \href{http://wiki.debian.org/Teams}{http://wiki.debian.org/Teams}
\item より経験豊富な貢献者から学ぶ素晴らしい方法!
\end{itemize}
\item 新しいソフトウェアを Debian に入れるなら
\begin{itemize}
\item できれば十分有用で興味深いソフトウェアだけにしてほしい
\item 代用品が既に Debian にあったりしないかい?
\end{itemize}
\end{itemize}
\paragraph{Ubuntu に興味がおありですか?}
\label{sec-6-2}

\begin{itemize}
\item Ubuntu は Debian の派生物を主に管理しています
\item 特定のパッケージに注目せず, Debian のチームと共同作業をしています.
\item 大抵の場合, 新しいパッケージは先ず Debian にアップロードすることを推奨:\newline
  \href{https://wiki.ubuntu.com/UbuntuDevelopment/NewPackages}{https://wiki.ubuntu.com/UbuntuDevelopment/NewPackages}
\item 多分良い方法は\ldots{}
\begin{itemize}
\item Debian のチームに参加して Ubuntu との橋渡しをする
\item 分岐を減らす作業. Launchpad のバグのトリアージ
\item 多くの Debian のツールが役に立つでしょう:
\begin{itemize}
\item Ubuntu column on the Developer's packages overview
\item Ubuntu box on the Package Tracking System
\item Receive launchpad bugmail via the PTS
\end{itemize}
\end{itemize}
\end{itemize}
\paragraph{みなしごパッケージの引き取り}
\label{sec-6-3}

\begin{itemize}
\item 全てのリスト: \href{http://www.debian.org/devel/wnpp/}{http://www.debian.org/devel/wnpp/}
\item \texttt{wnpp-alert} をインストールしよう
\item 異なるステータス
\begin{itemize}
\item \textalert{O}rphaned: \newline
    パッケージはメンテされていない. 自由に引き取れる
\item \textalert{RFA}: \textalert{R}equest \textalert{F}or \textalert{A}dopter \newline
    メンテナは里親を探しているが, 現時点ではメンテは継続して行なっている.
    引き取りは自由. 現メンテナへメールするのが良い.
\item \textalert{ITA}: \textalert{I}ntent \textalert{T}o \textalert{A}dopt \newline
    誰かがパッケージを引き取りを宣言した状態. 手助けを申し出ることはできる.
\item \textalert{RFH}: \textalert{R}equest \textalert{F}or \textalert{H}elp \newline
    メンテナが助けを求めている状態
\end{itemize}
\item 疑問点があれば \texttt{debian-qa@lists.debian.org}, もしくは
  \texttt{irc.debian.org} の \texttt{\#debian-qa} で問い合わせを!
\end{itemize}
\paragraph{作成したパッケージを Debian に入れるには?}
\label{sec-6-4}

\begin{itemize}
\item パッケージを Debian に入れるのには公式なステータスは不要です
\begin{enumerate}
\item ソースパッケージの準備をする
\item パッケージのスポンサーになってくれる Debian Developer を探す
\end{enumerate}
\item 公式なステータス:
\begin{itemize}
\item \textbf{Debian Maintainer(DM)}: \newline
    自分のパッケージをアップロードする権限を持つ開発者\newline
    \href{http://wiki.debian.org/DebianMaintainer}{http://wiki.debian.org/DebianMaintainer} 参照
\item \textbf{Debian Developer(DD)}: \newline
    Debian プロジェクトのメンバー.
   投票権を持ち, どんなパッケージでもアップロード可能
\end{itemize}
\end{itemize}
\paragraph{助けを得るには?}
\label{sec-6-5}

\begin{itemize}
\item Help you will need:
\begin{itemize}
\item あなたの質問に対して答と助言をくれて, コードもレビューしてくれて
\item パッケージの準備ができたらスポンサーにもなってくれて
\end{itemize}
\item You can get help from:
\begin{itemize}
\item パッケージングチームの他のメンバー: 最も良い方法
\begin{itemize}
\item あなたのパッケージ固有の事柄について知っている
\item チームのメンバーにあなたはなれる
\item \href{http://wiki.debian.org/Teams}{http://wiki.debian.org/Teams} 参照
\end{itemize}
\item Debian Mentors グループ(もしパッケージが合うチームが無いなら)
\begin{itemize}
\item \href{http://wiki.debian.org/DebianMentorsFaq}{http://wiki.debian.org/DebianMentorsFaq}
\item ML: \hyperref[debian-mentors-lists.debian.org]{debian-mentors@lists.debian.org}
\item IRC: \texttt{\#debian-mentors} on \texttt{irc.debian.org}
\item \href{http://mentors.debian.net}{http://mentors.debian.net}
\end{itemize}
\end{itemize}
\end{itemize}
\paragraph{公式ドキュメント}
\label{sec-6-6}

\begin{itemize}
\item Debian 開発者のコーナー: Debian の開発に関する多く資源へのリンク
\begin{itemize}
\item \href{http://www.debian.org/devel/}{http://www.debian.org/devel/}
\end{itemize}
\item Debian 新メンテナガイド: Debian パッケージ開発, 更新に関するドキュメント
\begin{itemize}
\item \href{http://www.debian.org/doc/maint-guide/}{http://www.debian.org/doc/maint-guide/}
\end{itemize}
\item Debian Developer's Reference: Debian における主な手続き. 第6章はパッケージ作成に関する良いドキュメント
\begin{itemize}
\item \href{http://www.debian.org/doc/developers-reference/}{http://www.debian.org/doc/developers-reference/}
\end{itemize}
\item Debian Policy: すべてのパッケージが満すべき条件. Perl や Java といった特定のパッケージに関するポリシーなど
\begin{itemize}
\item \href{http://www.debian.org/doc/debian-policy/}{http://www.debian.org/doc/debian-policy/}
\end{itemize}
\item Ubuntu Packaging Guide:
\begin{itemize}
\item \href{https://wiki.ubuntu.com/PackagingGuide}{https://wiki.ubuntu.com/PackagingGuide}
\end{itemize}
\end{itemize}
\paragraph{Debian dashboards for maintainers}
\label{sec-6-7}


\begin{itemize}
\item Source Package centric: Packaging Tracking System (PTS)
\begin{itemize}
\item \href{http://packages.qa.debian.org/dpkg}{http://packages.qa.debian.org/dpkg}
\end{itemize}
\item Maintainer/Team centric: Developer's Packages Overview (DDPO)
\begin{itemize}
\item \href{http://qa.debian.org/developer.php?login=pkg-ruby-extras-maintainers@lists.alioth.debian.org}{http://qa.debian.org/developer.php?login=pkg-ruby-extras-maintainers@lists.alioth.debian.org}
\end{itemize}
\end{itemize}
\subsection*{まとめ}
\label{sec-7}
\paragraph{まとめ}
\label{sec-7-1}

\begin{itemize}
\item パッケージ作成に関する全ての事柄について触れました
\item もっとドキュメントを読む必要があるでしょう
\item 今後発展していく事柄について学ぶ必要があるでしょう
\begin{itemize}
\item 不安なら
    \textbf{dh} と
    \textbf{3.0 (quilt)} フォーマットを使用しましょう
\end{itemize}
\item 本チュートリアルで触れていない事柄
\begin{itemize}
\item UCF: アップグレード時に変更点を設定する方法
\item dpkg triggers: メンテナスクリプトと共に動作するグループ
\item Debian 開発者組織:
\begin{itemize}
\item Bug Tracking System (BTS)
\item リリーススイート:
      stable, testing, unstable, experimental, security, *-updates, backports,
\item Debian ブレンド: ターゲットに特化した Debian のサブセット
\end{itemize}
\end{itemize}
\end{itemize}

\begin{center}
ご意見・ご感想: \textbf{uwabami@gfd-dennou.org}
\end{center}


\paragraph{Legal stuff(原文)}
\label{sec-7-2}
以下, 原文の Legal stuff です.

  Copyright \copyright 2011 Lucas Nussbaum -- lucas@debian.org

  {\small
    \textbf{This document is free software}: you can redistribute it and/or modify
    it under either (at your option):
    \begin{itemize}
    \item The terms of the GNU General Public License as published by the Free
      Software Foundation, either version 3 of the License, or
      (at your option) any later version.\\
      \url{http://www.gnu.org/licenses/gpl.html}
    \item The terms of the Creative Commons Attribution-ShareAlike 3.0 Unported
      License.\\
      \url{http://creativecommons.org/licenses/by-sa/3.0/}
    \end{itemize}
  }
\paragraph{Latest version \& source code}
\label{sec-7-3}

  \begin{itemize}
  \item Latest version:\\
{\footnotesize \url{http://git.debian.org/?p=collab-maint/packaging-tutorial.git;a=blob\_plain;f=packaging-tutorial.pdf;hb=refs/heads/pdf}}
  \end{itemize}

  \begin{itemize}
  \item Contribute:
      \begin{itemize}
          \item  {\small \texttt{git clone\\ git://git.debian.org/collab-maint/packaging-tutorial.git}}
    \item {\small \texttt{apt-get source packaging-tutorial}}
    \item {\small \url{http://git.debian.org/?p=collab-maint/packaging-tutorial.git}}
    \end{itemize}
  \item Feedback: \href{mailto:lucas@debian.org}{\textbf{\texttt{lucas@debian.org}}}
  \end{itemize}

\clearpage
%-------------------------------------------------------------------------------
\dancersection{今後の予定}{Debian JP}

\subsection{第51回関西 Debian 勉強会}

9 月 25 日(日)の第51回関西 Debian 勉強会は,
VCS-buildpackage again ということで,
山下尊也さんによる bzr-buildpackage のお話,
佐々木による git-buildpackage again の予定です.


% 冊子にするために, 4 の倍数にする必要がある.
% そのための調整
\dancersection{メモ}{}
\mbox{}\newpage

\printindex
 \cleartooddpage

 \begin{minipage}[b]{0.2\hsize}
  \rotatebox{90}{\fontsize{80}{80} {\gt 関西 Debian 勉強会} }
 \end{minipage}
 \begin{minipage}[b]{0.8\hsize}

 \vspace*{15cm}
 \rule{\hsize}{1mm}
 \vspace{2mm}
 \includegraphics[width=2cm]{image200502/openlogo-nd.eps}
 \noindent \Large \bf Debian 勉強会資料\\ \\
 \noindent \normalfont \debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日 \hspace{5mm}  初版第 1 刷発行\\
 \noindent \normalfont 関西 Debian 勉強会 (編集・印刷・発行)\\
 \rule{\hsize}{1mm}
 \end{minipage}

\end{document}
