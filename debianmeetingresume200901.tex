%; whizzy chapter
% -initex iniptex -latex platex -format platex -bibtex jbibtex -fmt fmt
% 以上 whizzytex を使用する場合の設定。


%     Tokyo Debian Meeting resources
%     Copyright (C) 2009 Junichi Uekawa

%     This program is free software; you can redistribute it and/or modify
%     it under the terms of the GNU General Public License as published by
%     the Free Software Foundation; either version 2 of the License, or
%     (at your option) any later version.

%     This program is distributed in the hope that it will be useful,
%     but WITHOUT ANY WARRANTY; without even the implied warranty of
%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.

%     You should have received a copy of the GNU General Public License
%     along with this program; if not, write to the Free Software
%     Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

%  preview (shell-command (concat "evince " (replace-regexp-in-string "tex$" "pdf"(buffer-file-name)) "&"))
% 画像ファイルを処理するためにはebbを利用してboundingboxを作成。
%(shell-command "cd image200901; ebb *.png")

%%ここからヘッダ開始。

\documentclass[mingoth,a4paper]{jsarticle}
\usepackage{monthlyreport}

% 日付を定義する、毎月変わります。
\newcommand{\debmtgyear}{2009}
\newcommand{\debmtgmonth}{1}
\newcommand{\debmtgdate}{17}
\newcommand{\debmtgnumber}{48}

\begin{document}

\begin{titlepage}
\thispagestyle{empty}

% タイトルページ:編集必要な部分は最初のマクロに飛ばすこと

\vspace*{-2cm}
第\debmtgnumber{}回 東京エリア Debian 勉強会資料

\hspace*{-2.4cm}
\includegraphics[width=210mm]{image200801/2008title.eps}\\
\hfill{}\debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日

\end{titlepage}

\dancersection{Introduction}{上川 純一}

\begin{multicols}{2}
 
 
 今月のDebian勉強会へようこそ。これからDebianの世界にあしを踏み入れると
 いう方も、すでにどっぷりとつかっているという方も、月に一回Debianについ
 て語りませんか？

 Debian勉強会の目的は下記です。

 \begin{itemize}
 \item \underline{Debian Developer} (開発者)の育成。
 \item 日本語での「\underline{開発に関する情報}」を整理してまとめ、アップデートする。
 \item \underline{場}の提供。
 \begin{itemize}
  \item 普段ばらばらな場所にいる人々が face-to-face で出会える場を提供
	する。
  \item Debian のためになることを語る場を提供する。
  \item Debianについて語る場を提供する。
 \end{itemize}
 \end{itemize}		

 Debianの勉強会ということで究極的には参加者全員がDebian Packageをがりがり
 と作るスーパーハッカーになった姿を妄想しています。情報の共有・活用を通し
 て Debianの今後の能動的な展開への土台として、「場」としての空間を提供す
 るのが目的です。

 2009年の計画は仮です。

 \begin{enumerate}
  \item 新年の企画 (アンサンブル荻窪開催)
  \item OSC
  \item (東京大学?)
  \item (千代田区都立図書館?\footnote{\url{http://www.library.chiyoda.tokyo.jp/}})
  \item (東京大学?)
  \item 
  \item スペインにて開催
  \item Debconf報告会
  \item 
  \item 
  \item 
  \item 忘年会
 \end{enumerate}


 会場候補としては下記があります:

 \begin{itemize}
  \item 大学
  \item 恵比寿SGIホール
  \item Googleオフィス
  \item 公民館(あんさんぶる荻窪等)
  \item 都立会議室(無線LAN)
  \item 健保の施設
 \end{itemize}

\end{multicols}


\newpage

\begin{minipage}[b]{0.2\hsize}
 \definecolor{titleback}{gray}{0.9}
 \colorbox{titleback}{\rotatebox{90}{\fontsize{80}{80} {\gt デビアン勉強会} }}
\end{minipage}
\begin{minipage}[b]{0.8\hsize}
\hrule
\vspace{2mm}
\hrule
\tableofcontents
\vspace{2mm}
\hrule
\end{minipage}

\dancersection{事前課題}{上川 純一}


2012年の正月、僕は実家に帰って旧友を深めるべく喫茶店にいた。最近ここら
へんには立ち寄っていないなぁ。そういうことをつらつらと思っているとふと
人影が目に入る。

「おぉ、待たせたな」

「あぁ。久しぶり」

「どうした」

「いや」

そして僕は手元のDebianデバイスから目をはなす。

「お、Debianの調子はどうよ、最近はどんな使い方しているの?」

この質問をいま僕にするなんて。血圧がすこし上がるのを感じながら
僕は饒舌になりすぎないように説明する。

「(A)」


{\bf 問題}

\begin{enumerate}
 \item Debianに関しての、2009年の抱負を述べよ
 \item 「2012のDebian」と題して(A)を埋めよ
\end{enumerate}

この課題に対して提出いただいた内容は以下です。

\input{image200901/prework.tex}

% image200901/prework.tex 内部にテキストを追加してください。
%
%


\dancersection{最近のDebian関連のミーティング報告}{上川 純一}
\subsection{東京エリアDebian勉強会47回目報告}
% (query-replace-regexp "<.*?>" "")
% (query-replace-regexp "^[	 ]\+" "")

東京エリアDebian勉強会報告。
2008年12月20日土曜日に11月の第47回東京エリアDebian勉強会を実施しました。
今回の参加者は
前田耕平さん、
一井崇さん、
やまだたくまさん、
小室文さん、
平澤俊雄さん、
藤沢理聡さん、
じつかたさん、
岩松信洋さん、
小林儀匡さん、
山本浩之さん、
キタハラさん、
日比野啓さん、
id774さん、
やまねひできさん、
でんさん、
でんさんの友人Aさん、
上川x2の
18名でした。

まず、2008年の勉強会の実績について上川が話をしました。
今回まとめてみた情報は、参加人数と事前課題の提出実績と
事後のブログ掲載の率です。
事後のブログ掲載は開催している側としては励みになるのでうれしい
というような話をした気がします。


次に上川が、2009年にむけて最近のトレンドについて
整理して、SWOTの図を作成するという企画をしました。
議論はいろいろと発散しましたが、アクションアイテムはたくさんでてきたので
これが次につながるとよいですね。


最後にライトニングトークを実施しました。
小林さんは apt-cache dotty の話。
id774さんはDebianユーザとしての告白。
上川は sqlite3 使って見ましたネタ。
やまだたくまさんは資料の翻訳のやりかたについて、機械翻訳をベースにどう労力を節約するかというネタ。
岩松さんは日本 . ユーザ会設立について。
前田さんはヨメをDebianユーザにする方法。
日比野さんはocamlユーザ会設立宣言。


% ===============================================================
\dancersection{Git+メールでの事前課題提出にまつわる課題}{上川純一}
\index{git}
% ===============================================================

2008年11月、12月、および2009年1月には事前課題をGitを利用してGitの生成する
パッチをメールで提出してもらうという形式にしていました。
その場合には git pull するたびにコンフリクトが発生します。
その原因となる仕組みと対策方法について説明します。

\subsection{コンフリクトが発生しやすい理由}

それでは、Debian 勉強会の2008年11,12月の資料でコンフリクトが発生しやすかっ
た理由を分析してみましょう。

\subsubsection{元のファイルの形式}

\begin{commandline}
-\subsection{}
+\subsection{XXXX}
+内容
+
\end{commandline}

同じファイルについて作業し、しかも同じ場所にすこしづつ異なる変更を別の人
が行うという仕組みになっていました。この場合、二つのパッチはかならずコン
フリクトし、手動で解消する必要があります。今回パッチが同じ場所に挿入して
いる場合に、順序は問わないので適当でよいのですが、\texttt{git apply} には
その知識はないため、毎回コンフリクトの解消を行います。

\subsubsection{メールを利用したサブミット}

\begin{figure}
 \includegraphics[width=\hsize]{image200901/qgit-trees.png}
 \caption{qgitでみたツリーの状況、手動でマージが複数発生している}
 \label{fig:mergedtokyodebian}
\end{figure}

締切り直前に作業するのが習慣のため、
複数の人がある時点の同じコミットに対してパッチを作成、
それを上川がある時点でマージしました(\fgref{fig:mergedtokyodebian})。

毎回コンフリクトが発生するのですが、それを上川が解消してマージとして記録
されています。そのため、各自が提出したバージョンとは若干違うパッチとなっ
てalioth.debian.orgにあるGitツリーにマージされています。

\subsection{マージ・コンフリクトの発生のしかた}

Gitはデフォルトではmasterブランチで作業します。\texttt{git pull} コマンドはAlioth
にあるリモートのツリーの情報をoriginブランチにとってきて、masterブランチ
にマージします。マージする内容がなければ、Fast-forward されます。

まず最初に各自が自分のGitツリーの master ブランチでパッチを作成します。そ
して、\texttt{git format-patch} の結果をパッチファイルとして送付します。上川が
\texttt{git am} でそのパッチを適用し、Alioth のGitツリーに公開します。複数人が同時
期に事前課題を提出しているため、\texttt{git am} でパッチを適用した場合にそのままで
は適用できない状況がおき、「コンフリクト」が発生します。「コンフリクト」
が発生した場合には上川が手動でその部分を修正します。

各自がAliothのGitツリーの最新バージョンを \texttt{git pull} で取得してくると
origin ブランチには上川の作成した変更を伴ったパッチが入ります。
masterブランチで自分の作成したものからは若干変更が加わっています。
そのため、内容に整合性がとれるとはかぎらないため、コンフリクトが発生しま
す。コンフリクトがおきなかったとしても履歴にマージが残ります。

\subsection{マージ・コンフリクトの解消方法}

\subsubsection{rebase して履歴をきれいにする}

マージなどを解消するためには、\texttt{git rebase -i origin} で不要なパッチを目視し
て消す作業をすればよいです。そもそも git pull --rebase すると、おそらくマー
ジが残らないが、コンフリクトの解消は必要になります。これは面倒です。

\subsubsection{作業の仕方を変える}

解決策としては、各自が提出用のブランチを作成してそこで作業し、そこで提出
用のデータを作成してしまえばよいというのがあります。

\begin{commandline}
 
$ git checkout -b preworkXXXX origin
$ # ... このブランチで作業
$ git format-patch ... 

# 提出してしまったらmasterブランチにもどる
$ git checkout master 
$ git pull # 上川の適用した版がとりこまれる

# さらに新しいブランチを作成して次の月の作業を行う
$ git checkout -b preworkYYYY origin
\end{commandline}

preworkXXXX ブランチを毎回捨てる。

\subsection{リポジトリ管理者側の課題}

マージするのが面倒です。

git am がコンフリクトを起こす確率が大きい。
パッチが置き換えでなく、元のデータに対しての追加のみになるように問題を設
定すると負荷は減る。
現状はマージで回避してみている。

\begin{commandline}
  git checkout -b マージ用のブランチ master
  git am -3 パッチ
  git checkout -b マージ用のブランチ master
  git am -3 パッチ
  git checkout master 
  git merge マージ用のブランチ
  コンフリクトの解消
  git merge マージ用のブランチ
\end{commandline}

ただ、10人以上の事前課題のハンドリングには時間もかかるので毎回したい作業
ではない。

自動でコンフリクトするかしないかについては判定できるし、その結果がビルド
するかはチェックできるのであれば、なんらかのデーモンを立ち上げることはできないか?

%============================================================
%\dancersection{XXX}{名前}
%\index{XXX}
%============================================================

\clearpage

%\printindex

\cleartooddpage

\vspace*{15cm}
\hrule
\vspace{2mm}
\includegraphics[width=2cm]{image200502/openlogo-nd.eps}
\noindent \Large \bf Debian 勉強会資料\\ \\
\noindent \normalfont \debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日 \hspace{5mm}  初版第1刷発行\\
\noindent \normalfont 東京エリア Debian 勉強会 （編集・印刷・発行）\\
\hrule


\end{document}
