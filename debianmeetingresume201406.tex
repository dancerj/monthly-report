%; whizzy chapter -dvi
% -initex iniptex -latex platex -format platex -bibtex jbibtex -fmt fmt
% 以上 whizzytex を使用する場合の設定。
 
%     Tokyo Debian Meeting resources
%     Copyright (C) 2012 Junichi Uekawa
%     Copyright (C) 2011 Nobuhiro Iwamatsu

%     This program is free software; you can redistribute it and/or modify
%     it under the terms of the GNU General Public License as published by
%     the Free Software Foundation; either version 2 of the License, or
%     (at your option) any later version.

%     This program is distributed in the hope that it will be useful,
%     but WITHOUT ANY WARRANTY; without even the implied warranty of
%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.

%     You should have received a copy of the GNU General Public License
%     along with this program; if not, write to the Free Software
%     Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

%  preview (shell-command (concat "evince " (replace-regexp-in-string "tex$" "pdf"(buffer-file-name)) "&"))

%%ここからヘッダ開始。

\documentclass[mingoth,a4paper]{jsarticle}
\usepackage{monthlyreport}
% 日付を定義する、毎月変わります。
\newcommand{\debmtgyear}{2014}
\newcommand{\debmtgmonth}{06}
\newcommand{\debmtgdate}{14}
% started from zero:
% (let ((year 2013) (month 7)) (+ (* (- year 2005) 12) month -1))
\newcommand{\debmtgnumber}{114}

\begin{document}

\begin{titlepage}
\thispagestyle{empty}
% タイトルページ:編集必要な部分は最初のマクロに飛ばすこと

\vspace*{-2cm}
第\debmtgnumber{}回 東京エリア Debian 勉強会資料\\
\hspace*{-2cm}
\includegraphics{image2012-natsu/dotdeb.pdf}\\
\hfill{}\debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日

% ここはアップデートすること
% 全角文字にしないとフォントのサイズが合わないので注意
\rotatebox{10}{\fontsize{32}{32} {\gt 特集：GPG 秘密鍵取り扱い方法の提案}}\\

\vspace*{-2cm}
\hfill{}\includegraphics[height=6cm]{image200502/openlogo-nd.eps}
\end{titlepage}

\newpage

\begin{minipage}[b]{0.2\hsize}
 \definecolor{titleback}{gray}{0.9}
 \colorbox{titleback}{\rotatebox{90}{\fontsize{80}{80} {\gt デビアン勉強会} }}
\end{minipage}
\begin{minipage}[b]{0.8\hsize}
\hrule
\vspace{2mm}
\hrule
\begin{multicols}{2}
\tableofcontents
\end{multicols}
\vspace{2mm}
\hrule
\end{minipage}

\dancersection{事前課題}{野島 貴英}

今回の事前課題は以下です:
\begin{enumerate}
 \item 本日、何の作業をやるかを宣言ください。
\end{enumerate}
この課題に対して提出いただいた内容は以下です。
\begin{multicols}{2}
{\small
% \input{image201406/prework.tex}
}
\end{multicols}

\dancersection{Debian Trivia Quiz}{野島 貴英}

ところで、みなさん Debian 関連の話題においついていますか？Debian関連の話
題はメーリングリストをよんでいると追跡できます。ただよんでいるだけではは
りあいがないので、理解度のテストをします。特に一人だけでは意味がわからな
いところもあるかも知れません。みんなで一緒に読んでみましょう。

今回の出題範囲は\url{debian-devel-announce@lists.debian.org} や \url{debian-devel@lists.debian.org}に投稿された
内容などからです。

\begin{multicols}{2}
\input{image201406/quiz.tex}
\end{multicols}

\dancersection{最近のDebian関連のミーティング報告}{野島 貴英}

\subsection{東京エリアDebian勉強会113回目報告}

 東京エリアDebian勉強会113回目は(株)スクウェア・エニックスさんで開催されました。

 8名の参加者がありました。また、野島さんより、仮想コンテナのフレームワークである
docker.ioについての発表が、実演ベースで行われました。
 
 また、残った時間は各自でもくもく作業をして、結果を発表しました。

　宴会は、会場近くの「南国亭新宿店」にて行いました。

% % (query-replace-regexp "<.*?>" "")
% % (query-replace-regexp "^[	 ]\+" "")

%-------------------------------------------------------------------------------
\dancersection{GPG 秘密鍵取り扱い方法の提案}{吉田 晋}
%-------------------------------------------------------------------------------
\index{gpg-private-keys-store-and-maniplate}

\subsection{はじめに}

皆さん、gpg のキーサインパーティーに参加した事ありますか？
私は、昨年の大統一 Debian 勉強会 2013 で初めて参加し、gpg の秘密鍵も、その時初めて作りました。
ところで、この秘密鍵はどのように保管すれば良いのでしょうか？

鍵はいつでも再発行出来るとはいえ色々と手間がかかりますし、古い鍵で暗号化したファイルを複合化出来なくなると困ります。
記録メディアの破損による鍵のロストには要注意です。
一般的に、記録メディアの破損に備えるには複数のメディアを複数の場所で保存する事は良い方法です。

一方、最低限のマナーとして盗難にも気をつける必要が有るでしょう。
厳重に管理するには、バックアップの数は少ないほど有利です。

さて、メディア破損に備えて冗長性を持たせる方法と盗難に備えて厳重に管理する方法は真っ向から矛盾してしまいました。
結局、どうすれば良いのでしょう？

\subsection{アイディアのベースは RAID}

例えば 3 本のディスクを用いた RAID5 のディスクアレイでは、2 個のディスクにデータを分散して記録しながら残りの 1 個のディスクにパリティデータを保存します。
同じ要領で秘密鍵を 2 個のファイル + 1 個のパリティファイル = 計 3 個のファイルを PC、USB メモリ（肌身離さず）、DVD（金庫）の 3 カ所で保存すれば、
\begin{itemize}
\item 普段は、USB メモリと PC を使って、都度鍵ファイルを復元して使用

  （使用後は鍵ファイル削除。削除忘れ防止のため、tmpfs 上で作ると良いかも。）
\item PC や USB メモリが盗まれても、しばらくは安全
\item ディスクのクラッシュや USB メモリの破損時には金庫の DVD を使って復元
\end{itemize}
という冗長性と秘匿性を兼ね備えた状態に成ります。
完全な鍵を世界中のどこにも保存する必要が無いところがポイント高！

ちなみに、分散するファイルの数を 2 倍にしたらどうなるでしょう？
秘密鍵を 4 個のファイル + 2 個 = 計 6 個のパリティファイルに分散すれば、パリティ増による冗長性の向上と、ファイル 1 個あたりの情報量減による秘匿性の向上を両立可能です。
\newpage

\subsection{プロトタイプ作ってみた}


プロトタイプは python 2.7 で作成し、 Debian sid で動作確認を行いました。

仕様
\begin{itemize}
\item パリティは 1 個で固定
\item 分散した各ファイルの最初にはメタ情報を json で保存。

  その後に 1 行空行を入れて、実際のデータを記入

  とりあえず、メタ情報は以下の 3 個 \begin{itemize}
  \item united\_length 元ファイルの長さ
  \item split\_count 何個に分割したか。（最低 2。）

    この数とパリティファイル 1 個、最低 3 個のファイルが出来る
  \item index 何番目のファイルか。（0 始まり。）

    index = split\_count の時は、パリティファイル
  \end{itemize}
\item 元ファイルを 1 byte ずつ分割。

  united\_length が split\_count で割り切れない場合は 0 でフィリング
\item 最後のファイル書き出し時以外は全てオンメモリで処理。

  一時ファイルは作りません
\end{itemize}
split\_count = 2 の場合、奇数目 byte を index = 0 のファイルに、偶数目 byte を index = 1 のファイルに、パリティ情報を index = 2 のファイルに保存

\subsection{悩み}
\begin{itemize}
\item python で実装したが、果たして良かったのか？

  debian の最小構成で python が入っていない

  （gpg コマンドは入っている）

  パッケージ化を目指すなら、C で再実装した方が良いかも
\item メタ情報を json で保存して良かったのだろうか？

  今後メタ情報が増えた場合に、文字列と数字の区別が出来たら便利だと思って json にした。

  しかし、C で実装する場合は json のパースは面倒。

  何より、現状では json の中で改行 x 2 が入ったらバグるので何とかする必要あり。
\item オンメモりの処理にどこまでこだわるか？

  OS 上のファイルとしては存在しなくとも、ディスクに少しでもデータが残ると盗難時に解析される恐れがあるのでオンメモリの処理にこだわった。

  でも、よく考えると SWAP したら意味が無いし、最初に秘密鍵を生成する際にディスク上に一時保存したら終わり。

  大容量のファイルを分割する事に備えて、名無しの一時ファイル（開いた直後に OS で削除）くらいは使っても良いかも。
\end{itemize}

\subsection{今後の予定}
他に使う人がいそうなら、こんな事しようと思っています。

\begin{itemize}
\item ドキュメント作成
\item C 言語で再実装？
\item RAID6 のように、複数のパリティに対応
\item 複数のアルゴリズムを選べるようにする
\end{itemize}

\printindex

\cleartooddpage

\vspace*{15cm}
\hrule
\vspace{2mm}
\includegraphics[width=2cm]{image200502/openlogo-nd.eps}
\noindent \Large \bf Debian 勉強会資料\\
\noindent \normalfont \debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日 \hspace{5mm}  初版第1刷発行\\
\noindent \normalfont 東京エリア Debian 勉強会 （編集・印刷・発行）\\
\hrule

\end{document}
