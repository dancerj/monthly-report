%; whizzy chapter
% -initex iniptex -latex platex -format platex -bibtex jbibtex -fmt fmt
% 以上 whizzytex を使用する場合の設定.

%     Kansai Debian Meeting resources
%     Copyright (C) 2007 Takaya Yamashita
%     Thank you for Tokyo Debian Meeting resources

%     This program is free software; you can redistribute it and/or modify
%     it under the terms of the GNU General Public License as published by
%     the Free Software Foundation; either version 2 of the License, or
%     (at your option) any later version.

%     This program is distributed in the hope that it will be useful,
%     but WITHOUT ANY WARRANTY; without even the implied warranty of
%     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%     GNU General Public License for more details.

%     You should have received a copy of the GNU General Public License
%     along with this program; if not, write to the Free Software
%     Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301 USA

%  preview (shell-command (concat "evince " (replace-regexp-in-string "tex$" "pdf"(buffer-file-name)) "&"))
% 画像ファイルを処理するためには ebb を利用して boundingbox を作成.
%(shell-command "cd image200708; ebb *.png")

%%ここからヘッダ開始.

\documentclass[mingoth,a4paper]{jsarticle}
\usepackage{kansaimonthlyreport}
\usepackage[dvips]{xy}
\usepackage{ascmac}

% 日付を定義する, 毎月変わります.
\newcommand{\debmtgyear}{2011}
\newcommand{\debmtgdate}{23}
\newcommand{\debmtgmonth}{01}
\newcommand{\debmtgnumber}{43}

\begin{document}

\begin{titlepage}

% 毎月変更する部分, 本文の末尾も修正することをわすれずに

 第\debmtgnumber{}回 関西 Debian 勉強会資料

\vspace{2cm}

\begin{center}
\includegraphics{image200802/kansaidebianlogo.png}
\end{center}

\begin{flushright}
\hfill{}関西 Debian 勉強会担当者 佐々木・倉敷・のがた \\
\hfill{}\debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日
\end{flushright}

\thispagestyle{empty}
\end{titlepage}

\dancersection{Introduction}{Debian JP}

\subsection*{}%ロゴ用のスペース稼ぎ

関西 Debian 勉強会は Debian GNU/Linux のさまざまなトピック (新しいパッケー
ジ, Debian 特有の機能の仕組, Debian 界隈で起こった出来事, などなど) に
ついて話し合う会です.

目的として次の三つを考えています.
\begin{itemize}
      \item ML や掲示板ではなく, 直接顔を合わせる事での情報交換の促進
      \item 定期的に集まれる場所
      \item 資料の作成
\end{itemize}

それでは, 楽しい一時をお楽しみ下さい.

\clearpage

\begin{minipage}[b]{0.2\hsize}
 {\rotatebox{90}{\fontsize{80}{80}
{\gt 関西 Debian 勉強会}}}
\end{minipage}
\begin{minipage}[b]{0.8\hsize}
\hrule
\vspace{2mm}
\hrule
\setcounter{tocdepth}{1}
\tableofcontents
\vspace{2mm}
\hrule
\end{minipage}

\dancersection{最近の Debian 関係のイベント報告}{Debian JP}

\subsection{squeeze いよいよついにリリース……か……？}
この原稿を書いている時点で、
squeeze のリリース日程として、具体的に 2 月 5 日前後という話がでてきています(RC バグもついに残り 39 という状況です)。
期待しすぎるのも危険ですが、次回の勉強会では squeeze を安定版として語りたいですね。
\begin{figure}[h!]
  \centering
  \includegraphics[width=0.7\textwidth]{./image201101/rc-status-20110123.png}
  \caption{現状の RC バグの状況. 緑の線が「次期リリースに関連する RC バグの数」です. 本原稿執筆時点では残り 39 個です.}
\end{figure}

そんな中、2011/01/22 に(日本時間では 23 日未明, つまりこの原稿を書いている時に)
Lenny 最後の point release(になるであろう) 5.0.8 がリリースされました\footnote{\url{http://www.debian.org/News/2011/20110122}}。


\subsection{第 42 回関西 Debian 勉強会}
前回の関西 Debian 勉強会は 12 月 23 日大阪福島区民センターで開かれました.

森山さんによる「Proxmox VE の紹介」セッションと、関西 Debian 勉強会
の 1 年の振りかえりを行ないました。

Proxmox については、便利なのにあまり知られていないということもあり、
知名度向上に一役買ったのではないでしょうか。
実機デモや実際の活用も交えた紹介で、わかりやすいセッションだったと
思います。インストールさえしてしまえば、中身は普通に Debian ですので、
皆さんも是非使ってみてください。

振りかえりの方は、去年の年初にあがっていた目標の状況おさらいや、今年の
ネタをどう進めていくか、などをディスカッションしました。
途中で検討が少し中だるみしてしまったのは残念でしたが、引き続き開催して
いきますのでよろしくお願いします。提案やご希望などはいつでも歓迎です。

\subsection{第 71 回東京エリア Debian 勉強会}
2010 年 12 月 18 日に開催され, libsane と CACert の話題があったそうです。

\subsection{第 72 回東京エリア Debian 勉強会}
2011年1月15日に開催され、Debian 勉強会のアンケートシステム解説と、
話題の kinnect を Debian で使うセッションがありました。

また、前回に引き続き CACert のサイン会も実施されたようです。最近
東京では CACert が流行っているようですね。

\begin{figure}[h!]
  \centering
  \includegraphics[width=.6\textwidth]{./image201101/kinect.jpg}
  \caption{Kinect で踊る皆さん}
  \label{fig:kinect}
\end{figure}

\clearpage
\dancersection{事前課題}{Debian JP}

今回は以下の課題を設定しました.
%
\begin{quote}
    \begin{screen}
一つバグをみつけてきて下さい. ご意見要望でもかまいません.
    \end{screen}
\end{quote}
%
参加者の皆さんによる回答は以下の通りです.

\begin{prework}{ 甲斐正三 }

  \begin{description}
  \item [未解決事項（私にとって）]
    texworksにおいて日本語が使用できない。
  \item [環境:]
    Debian squeeze,texworks ver0.2.3
  \item [補足:]
    バグなのか、設定が適正でないからなのかわかっていません。
  \item [今後の予定:]
    他のdistroでも同様なのか確認してみます。
  \item [Texの用途:]
    タイミングチャート（図）を含む文章を整形したい。
  \item [その他:]
    申込が遅くなり申し訳ございません\footnote{いえいえ. 毎度ご参加ありがとうございます(佐々木)}。
  \end{description}
\end{prework}

\begin{prework}{ かわだてつたろう }

当日までに何かみつけます。。。

\end{prework}

\begin{prework}{ 山田 洋平 }

去年、はじめてバグを報告し、パッケージを修正してもらえました。
今回は要望を挙げてみたいと思います。日本語環境を改善したいので、当日までに状況を調べて来ます。

\end{prework}

\begin{prework}{ 八津尾 }

要望: Anthyの学習量上限を増やして欲しいなぁ

\end{prework}

\begin{prework}{ dictoss(杉本 典充) }

kfreebsd-amd64環境で、iceweaselで使っているときにハイパーリンク部のテキストをクリックするとフリーズする場合がある。このとき、タブの読み込み中のくるくる回るアニメーションもフリーズする。
\end{prework}



\begin{prework}{ 佐々木洋平 }
  \begin{itemize}
  \item yaskkserv: daemon が動作していない時に /etc/init.d/yaskkserv restart すると error
    \begin{commandline}
      % sudo /etc/init.d/yaskkserv stop
      % sudo /etc/init.d/yaskkserv restart
      Restarting yaskkserv: yaskkservkill: 297: Usage: kill [-s sigspec | -signum | -sigspec] [pid | job]... or
      kill -l [exitstatus]
    \end{commandline}
  \item howm: howm-vars.el を byte-compile すると old-style backqoutes\footnote{原稿執筆時に修正箇所に気がついたので直してしまいましたが...}
  \item elscreen: emasc22 は elscreen 使うと, 起動時にファイルが開けません.
    \begin{itemize}
    \item unstable ではなおってますので backports しましょう.
    \end{itemize}
  \item ptex-base,ptex-bin (wishlist): UTF-8 が通りません.
  \end{itemize}
\end{prework}

\begin{prework}{ dpqpqb }

lenny のシャットダウン中にハングする場合が有る.
仕方無しに電源ボタンの長押しで対処してます.
\begin{itemize}
\item Debian 5.0.8
\item Kernel 2.6.26-2-686
\item GNOME  2.22.3
\end{itemize}
\end{prework}

\begin{prework}{ 山下康成 }

http://www.debian.org/releases/squeeze/armel/apds03.html.ja
D.3.4.1. デバイスファイルの作成 には,
\begin{commandline}
次のようにして, デフォルトの静的デバイスファイル群を作成します.

# cd /dev
# MAKEDEV generic
\end{commandline}
との記述がありますが, 記述の通りに実行すると,
\begin{commandline}
# MAKEDEV generic
.udevdb or .udev presence implies active udev.  Aborting MAKEDEV invocation.
#
\end{commandline}
となります
\end{prework}

\begin{prework}{ 川江 }

バグについてですが, 以前にも話した事があるようにスクリプトやパッケージが自分の「意図」と異なる動きをしたときに, それが「バグ」なのか「設定ミス」なのか分からないときがあります. Xen で言えば時刻の設定や iptables で forward を有効に設定した場合に各 DomainU が外部に接続できなくなるなどです.
\end{prework}

\begin{prework}{ 松澤二郎 }

reportbug がローカライズされていない. gettext のラッピングさえしてなさげ.
(むしろ意図的? 当然英語を使えよな, と暗にほのめかしている気もする)
\end{prework}

\begin{prework}{ bpasao }

(無回答)

\end{prework}

\begin{prework}{ lurdan }

{\url{http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=607721}}

ITP のサンプルです.
\end{prework}

\begin{prework}{ のがたじゅん }

gpsbabel-gui パッケージで desktop ファイルがないのでメニューに反映されない.

\end{prework}

\dancersection{Debian GNU/kFreeBSD で便利に暮らすための Tips}{杉本典充}

\subsection{Debian GNU/kFreeBSD について}
Debian GNU/kFreeBSD とは, Debian Project で開発しているオペレーティングシステムのひとつです. Squeeze にて技術プレビュー版としてリリースされることになっています. \footnote{http://www.debian.org/ports/kfreebsd-gnu/}

\subsubsection{Debian GNU/kFreeBSD の現状}
Debian GNU/kFreeBSD は現在次のような状況です.

\begin{itemize}
  \item カーネルは FreeBSD 8.1 ベースのものに一本化された. (7.3 カーネルは廃止).
  \item まだ Linux バイナリ互換機能は動かない模様. (linux.ko のロード自体に失敗する).
  \item FreeBSD 本家では 8.2 のリリースが間近のため, Debian GNU/kFreeBSD でもアップデートを作業中 (2011/1/12 にカーネルの新しいバージョン 8.2-rc1 がアップロードされた).
\end{itemize}

\subsection{ZFS 環境下でリアルタイム系アプリケーションを使用する Tips}
\subsubsection{現象}
私の PC 環境では, sftp を実行してサーバから 1GB のファイルをダウンロードすると, audacious で再生中の MP3 ファイルが音飛びします. ディスクのアクセス LED は「消灯, 数秒間連続点灯, 消灯」を繰り返すようなディスクアクセスをしており, 音飛びは HDD LED が点灯中に発生します.

なお, PC の環境は以下です.

\begin{itemize}
  \item ノート PC の VAIO TZ. 2.5inch HDD (SATA150 接続) の 250GB.
  \item / は UFS, /home は ZFS としている.
  \item ZFS の設定で, 圧縮はしない (compression=off) 設定にしている.
  \item 再生する MP3 ファイルと sftp でダウンロードする 1GB のファイルは双方 ZFS 領域に読み書きする.
\end{itemize}

\subsubsection{原因の推定}
ディスクのアクセス LED が点灯しているときに MP3 ファイルの再生が音飛びするため, 1GB のファイルを書き込み中に MP3 ファイルの読み込みが行えななかったためと推測します.

そのため, 大きいファイルを書き込む場合でもディスクへの連続書き込み時間を短くするように ZFS のパラメータを調整すれば現象は解決すると考えます.

ZFS のパラメータ設定については FreeBSD を使う人たちで研究されており, その結果が公開されています. \footnote{http://wiki.freebsd.org/ZFSTuningGuide}

\subsubsection{ZFS のパラメータを調整する}
ZFS のパラメータを表示するには"sysctl''コマンドを使用します.
今回調整するパラメータは'vfs.zfs.arc\_max'のため, 現在の値を確認します.

\begin{commandline}
$ sysctl -a | grep arc_max
vfs.zfs.arc_max: 428705280
\end{commandline}

デフォルト値は約 400MB に設定されています.

FreeBSD における ZFS のパラメータ設定は"/boot/loader.conf''に記述するのですが, Debian GNU/kFeeeBSD では"/boot/loader.conf''に記述しても効きません.
また, カーネルの起動後に"sysctl'コマンドを直接実行してもすでに ZFS subsystem が起動しているため変更できない状況です.

そのため, grub の起動パラメータとして設定する方法をとりました.

\begin{commandline}
$ sudo vim /etc/grub.d/10_kfreebsd
# (省略)
# 元から設定しているパラメータ
set kFreeBSD.vfs.root.mountfrom=${kfreebsd_fs}:${kfreebsd_device}
set kFreeBSD.vfs.root.mountfrom.options=rw

# 今回新しい設定値を追加します.
set kFreeBSD.vfs.zfs.arc_max="100M"
# (省略)
$ sudo update-grub
$ sudo reboot
\end{commandline}

\subsubsection{確認}

\begin{commandline}
$ sysctl -a | grep arc_max
vfs.zfs.arc_max: 104857600
\end{commandline}

設定した通り, 100MB になりました.
これでテストしてみると音飛びがしなくなりました.

このパラメータ値はハードウェア環境, ディスク負荷で個々に違ってくるため, 皆さんの使い方に合わせてチューニングしてみてください.

\subsection{USB メモリのマウントに関する Tips}
\subsubsection{まず普通にやってみる}
私の Debian GNU/kFreeBSD 環境は"ja\_JP.UTF-8''の locale を使用しています.
FAT32 でフォーマットしている USB メモリに日本語ファイル名をもつファイルがある場合は mount 時に文字コードの変換が必要になります.
そのため, 文字コード変換のオプションを指定してマウントを試みます.

すると"libiconv.so''がないといわれ, エラーになります.

\begin{commandline}
$ sudo mount_msdosfs -L ja_JP.UTF-8 -D CP932 /dev/da0 /mnt/usb
mount_msdosfs: Unable to load iconv library: libiconv.so: cannot open shared object file: No such file or directory
: No such file or directory
mount_msdosfs: msdosfs_iconv: No such file or directory
\end{commandline}

\subsubsection{libiconv のビルド}
しかし Debian には libiconv.so というライブラリファイルは存在しません.
そのため, GNU のサイトから tarball をダウンロードして build することにします.

\begin{commandline}
$ cd
$ mkdir tmp
$ wget http://ftp.gnu.org/pub/gnu/libiconv/libiconv-1.13.1.tar.gz
$ tar zxvf libiconv-1.13.1.tar.gz
$ cd libiconv-1.13.1
$ ./configure
$ make
$ sudo make install
$ ls /usr/local/lib
charset.alias  libcharset.so        libiconv.la    libiconv.so.2.5.0
libcharset.a   libcharset.so.1      libiconv.so    python2.6
libcharset.la  libcharset.so.1.0.0  libiconv.so.2  site_ruby
\end{commandline}


再度 mount を試みます.
コマンド自体はエラーになりませんが, /mnt/usb の中を ls してみると, 日本語部分が
? で表示されています. 文字コードの変換に失敗したようです.

\begin{commandline}
$ sudo mount_msdosfs -L ja_JP.UTF-8 -D CP932 /dev/da0 /mnt/usb
\end{commandline}

\subsubsection{文字コード変換の失敗原因}
FreeBSD 本家のカーネルでも mount\_msdosfs で UTF-8 へ文字コードを変換する処理は動作しないようです. \footnote{日本語の UTF-8 へファイル名を変換して mount できるようにするパッチは FreeBSD を使う有志によって作成されているようですが, GENERIC カーネルに取り込まれていないようです. }
そのため, 考えられる方法は以下の 3 つありそうです.

\begin{itemize}
  \item USB メモリに日本語ファイル名を使わない. (他人からもらったデータの場合は都合が悪い場合もある).
  \item locale の設定を"ja\_JP.eucJP'で運用する. (eucJP への変換は動作するため)
  \item 一時的に locale を"ja\_JP.eucJP''に設定して USB メモリから HDD にコピーし, convmv で UTF-8 へファイル名を変換する. その後, locale を"ja\_JP.UTF-8''に戻す.
\end{itemize}

私の環境ではすでに UTF-8 の文字コード環境を使っている都合上, convmv を使った方法を紹介します.


まずは, ja\_JP.eucJP 環境で起動します.
\begin{commandline}
$ vim .xinitrc
# export LANGUAGE='ja_JP.UTF-8'
# export LC_ALL='ja_JP.UTF-8'
# export LANG='ja_JP.UTF-8'
export LANGUAGE='ja_JP.eucJP'
export LC_ALL='ja_JP.eucJP'
export LANG='ja_JP.eucJP'
$ startx
\end{commandline}

ファイルを一度 HDD にコピーし, コピーしたファイル名の文字コードを変換します.
\begin{commandline}
$ sudo mount_msdosfs -L ja_JP.eucJP -D CP932 /dev/da0 /mnt/usb
$ mkdir ~/usbtmp
$ cd ~/usbtmp
$ cp -r /mnt/usb/* ./
$ convmv -r -f eucjp -t utf8 * --notest
\end{commandline}

locale を元に戻します.

\begin{commandline}
$ vim .xinitrc
export LANGUAGE='ja_JP.UTF-8'
xxport LC_ALL='ja_JP.UTF-8'
export LANG='ja_JP.UTF-8'
# export LANGUAGE='ja_JP.eucJP'
# export LC_ALL='ja_JP.eucJP'
# export LANG='ja_JP.eucJP'
$ startx
\end{commandline}

一手間必要ですが, locale を"ja\_JP.UTF-8"で使う場合はこのような回避策を行うことで対応することができます.

\subsection{今後の課題}
日常生活で使えると便利な以下の事項については, 現在調査中です.

\begin{itemize}
  \item iceweasel がよくフリーズする. (代わりに epiphany-browser を使用している).
  \item Flash はやはり鬼門で安定して動作できていない. (gnash はひとまず purge している).
  \item VAIO TZ の液晶の明るさ変更 (Fn キーから音量は何もしなくても変更できているが…).
  \item 無線 LAN (iwn0 として内蔵無線 LAN カードの認識はできているがエラーになる)
  \item IS03 を使ってテザリングする. (まずはドライバをなんとかしないと)
\end{itemize}

\subsection{終わりに}
Debian GNU/kFreeBSD はこれから更に完成度を高めていけるオペレーティングシステムのため, オペレーティングシステムの開発に関わりたい人には打ってつけのプロジェクトです.
今後も Debian GNU/kFreeBSD を使い, デバッグしながらいろいろ勉強していきたいです.

みなさまも機会があれば Debian GNU/kFreeBSD を使ってみてください.

\dancersection{reportbug のなんとか}{のがたじゅん}

ここにのがたが reportbug について書く.


\dancersection{今後の予定}{Debian JP}

\subsection{次回の関西 Debian 勉強会}
次回の関西 Debian 勉強会は 2 月 27 日 (日), 大阪福島区民センターか大阪港区区
民センターのどちらかで行われる予定です.

発表については未定ですので, みなさまの発表をお待ちしております.

\subsection{4 月神戸 IT フェスティバル + オープンソースカンファレンス 2011Kansai@Kobe}

4 月 15 日 (金), 16 日 (土) に JR 神戸駅すぐの神戸市産業振興センターにて, 神戸 IT フェ
スティバル + オープンソースカンファレンス 2011Kansai@Kobe が開催されますがど
うしましょ.


% 冊子にするために, 4 の倍数にする必要がある.
% そのための調整
%\dancersection{メモ}{}
%\mbox{}\newpage

%\printindex
 \cleartooddpage

 \begin{minipage}[b]{0.2\hsize}
  \rotatebox{90}{\fontsize{80}{80} {\gt 関西 Debian 勉強会} }
 \end{minipage}
 \begin{minipage}[b]{0.8\hsize}

 \vspace*{15cm}
 \rule{\hsize}{1mm}
 \vspace{2mm}
 \includegraphics[width=2cm]{image200502/openlogo-nd.eps}
 \noindent \Large \bf Debian 勉強会資料\\ \\
 \noindent \normalfont \debmtgyear{}年\debmtgmonth{}月\debmtgdate{}日 \hspace{5mm}  初版第 1 刷発行\\
 \noindent \normalfont 関西 Debian 勉強会 (編集・印刷・発行)\\
 \rule{\hsize}{1mm}
 \end{minipage}

\end{document}
